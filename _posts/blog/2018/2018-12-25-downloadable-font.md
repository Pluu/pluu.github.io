---
layout: post
title: "[ë²ˆì—­] DroidKaigi 2018 ~ Support Libraryì˜ Downloadable Fontì™€ EmojiCompatì„ ëŒ€ì‘í•˜ëŠ” ì•±ì„ ë§Œë“¤ì"
date: 2018-12-25 19:00:00 +09:00
tag: [Android, DroidKaigi]
categories:
- blog
- Android
- DroidKaigi
---

ë³¸ í¬ìŠ¤íŒ…ì€ [DroidKaigi 2018 ~ Support Libraryã®Downloadable Fontsã‚„EmojiCompatã«å¯¾å¿œã—ãŸã‚¢ãƒ—ãƒªã‚’ä½œã‚ã†](https://speakerdeck.com/takahirom/support-libraryfalsedownloadable-fontsyaemojicompatnidui-ying-sitaapuriwozuo-rou) ì„ ê¸°ë³¸ìœ¼ë¡œ ë²ˆì—­í•˜ì—¬ ì‘ì„±í–ˆìŠµë‹ˆë‹¤

ì œ ì¼ë³¸ì–´ ì‹¤ë ¥ìœ¼ë¡œ ì¸í•˜ì—¬ ì˜¤ì—­ì´ë‚˜ ì˜¤íƒ€ê°€ ë°œìƒí•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

<!--more-->

- - -

## 1p, Support Libraryì˜ Downloadable Fontì™€ EmojiCompatì„ ëŒ€ì‘í•˜ëŠ” ì•±ì„ ë§Œë“¤ì

DroidKaigi 2018

takahirom

## 2p, ìê¸° ì†Œê°œ

- takahirom([@new_runnable](twitter.com/new_runnable))
- ë³¸ëª…ì€ æ¯›å— å´‡æ´‹ (ã‚ã‚“ã˜ã‚…ãŸã‹ã²ã‚)
- Androidë¥¼ ì¢‹ì•„í•¨
- AbemaTV Android ì•±ì„ ë§Œë“¤ê³  ìˆìŠµë‹ˆë‹¤.


- DroidKaigi 2018 ê³µì‹ ì•±ì˜ ë¦¬ë”ë¥¼ ë§¡ê³  ìˆìŠµë‹ˆë‹¤. 
  350 ê°œ ì´ìƒì˜ Pull Request ê°ì‚¬í•©ë‹ˆë‹¤. ğŸ™‡ğŸ»â€â™‚ï¸
  ì„¤ì¹˜í•˜ì§€ ì•Šìœ¼ì…¨ë‹¤ë©´ ì„¤ì¹˜í•´ì£¼ì„¸ìš”

### 3p, ëª©ì°¨

- Downloadable Font
  - Downloadable Font ì†Œê°œ
  - Font Resource ì†Œê°œ
  - Downloadable Fontë¥¼ ì‚¬ìš©í•´ë³´ì
  - Downloadable Font êµ¬ì¡°
  - ì–´ë–»ê²Œ Downloadable Fontë¥¼ ì‚¬ìš©í• ê¹Œ?
- EmojiCompat
  - EmojiCompat ì†Œê°œ
  - EmojiCompat êµ¬ì¡°
  - ì–´ë–»ê²Œ EmojiCompatë¥¼ ì‚¬ìš©í• ê¹Œ?
- í…ŒìŠ¤íŠ¸ë°©ë²•
- ì •ë¦¬

### 4p, Downloadable Font

### 5p ~ 9p, Downloadable Font ë€

- Fontë¥¼ ì–»ì–´ë‚´ëŠ” êµ¬ì¡°
- Google I/O 2017ì—ì„œ What's New In Androidì—ì„œ ë°œí‘œ
- Android 8.0 (API Level 26)ê³¼ Support Library 26ì—ì„œ ì‚¬ìš© ê°€ëŠ¥
- Android 4.0 (API Level 14) ì´ìƒì—ì„œ ë™ì‘

### 10p ~ 15p, Downloadable Font ë€

- í”„ë¡œê·¸ë¨ í˜¹ì€ ë¦¬ì†ŒìŠ¤ë¡œë¶€í„° ì–»ëŠ”ë‹¤

<img src="https://developer.android.com/guide/topics/ui/images/look-and-feel/downloadable-fonts/downloadable-fonts-process.png" width="300" />

- Google Play Servicesì— Font Providerê°€ ìˆì–´, ê±°ê¸°ì—ì„œë¶€í„° ì–»ëŠ”ë‹¤
  - ì•±ì— í°íŠ¸ë¥¼ ë„£ì§€ ì•ŠëŠ”ë‹¤
  - ì•±ì´ í°íŠ¸ë¥¼ ì§ì ‘ ë‹¤ìš´ë¡œë“œí•˜ì§€ ì•ŠëŠ”ë‹¤
- Google Play Servicesê°€ í°íŠ¸ë¥¼ ìºì‹œí•´ì„œ ì¤€ë‹¤

> [https://developer.android.com/guide/topics/ui/look-and-feel/downloadable-fonts](https://developer.android.com/guide/topics/ui/look-and-feel/downloadable-fonts) ë¡œë¶€í„°

### 16p ~ 19p, Downloadable Font ì¥ì 

- ì»¤ìŠ¤í…€ í°íŠ¸ë¥¼ ì ìš©í•  ìˆ˜ ìˆë‹¤
  - ë¨¸í‹°ë¦¬ì–¼ ë””ìì¸ ëŒ€ì‘
  - ë‹¨ë§ ê³ ìœ ì˜ í°íŠ¸ë¥¼ ì‚¬ìš©í•˜ì§€ ì•Šì•„ë„ ëœë‹¤
- APK ì‚¬ì´ì¦ˆë¥¼ ì¤„ì¼ ìˆ˜ ìˆë‹¤
  - ê·¸ë³´ë‹¤ ì•±ì˜ ì¸ìŠ¤í†¨ ì„±ê³µë¥ ì„ ëŠ˜ë¦´ ìˆ˜ ìˆë‹¤!
- Fontë¥¼ ë‹¤ë¥¸ ì•±ê³¼ ê³µìœ í•  ìˆ˜ ìˆë‹¤
  - í†µì‹ ëŸ‰ ê°ì†Œ
  - ë©”ëª¨ë¦¬ ì‚¬ìš©ëŸ‰ ê°ì†Œ
  - ì €ì¥ê³µê°„ ê°ì†Œ

### 20p

Downloadable Font êµ¬ì¡°ê°€ í¬í•¨ëœ Font Resourceì— ëŒ€í•´ì„œ

### 21p ~ 24p, Font Resource

res/font/hogehoge.ttf â†’ R.font.hogehoge

```xml
<TextView android:fontFamily="@font/hogehoge"
```

Bundled Fontì™€ Downloadable Font 2ì¢…ë¥˜ê°€ ìˆë‹¤

### 25p, Font Resource ~ Bundle Font / Font File

- Font Fileì„ ê·¸ëŒ€ë¡œ ë„£ëŠ”ë‹¤ (.otf, .ttf, .ttc)

### 26p, Font Resource ~ Bundle Font / font-family(.xml)

```xml
<?xml version="1.0" encoding="utf-8"?>
<font-family xmlns:app="../apk/res-auto">
    <font
        app:font="@font/orbitron_regular"
        app:fontStyle="normal"
        />
    <font
        app:font="@font/orbitron_bold"
        app:fontStyle="normal"
        app:fontWeight="700"
        />
</font-family>

<TextView
    android:fontFamily="@font/orbitron"
    android:textStyle="bold"
```

textStyleë¡œ ë¶€í„° ì‚¬ìš©í•  Fontë¥¼ ë³€ê²½í•œë‹¤

### 27p

Downloadable Fontë¥¼ ì ìš©í•˜ëŠ” ë°©ë²•ì„ ë³´ê² ìŠµë‹ˆë‹¤

### 28p ~ 31p, Downloadable Font ì–´ë–»ê²Œ ì ìš©í• ê¹Œ?

Android Studio ì˜ ë ˆì´ì•„ì›ƒ ë‚´ì—ì„œ fontFamilyë¥¼ ì„ íƒí•˜ê³  More Fontsâ€¦ë¥¼ ì„ íƒ

<img src="https://developer.android.com/guide/topics/ui/images/look-and-feel/downloadable-fonts/layout-editor.png" />

- í°íŠ¸ë¥¼ ì„ íƒí•œë‹¤
- Create downloadable fontë¥¼ ì„ íƒí•œë‹¤
- OKë¥¼ ëˆ„ë¥¸ë‹¤

<img src="https://developer.android.com/guide/topics/ui/images/look-and-feel/downloadable-fonts/resources-window.png" />

> ì´ë¯¸ì§€ëŠ” ë°œí‘œ ì´ë¯¸ì§€ì™€ ë‹¤ë¥¸, Android Developer ê³µì‹ ì‚¬ì´íŠ¸ì˜ ì´ë¯¸ì§€ê°€ ì‚¬ìš©ë˜ì—ˆìŠµë‹ˆë‹¤.

### 32p, ì–´ë–»ê²Œ ì ìš©í• ê¹Œ? (2/2)

ì™„ì„±

### 33p, ì´ ë³€ê²½ìœ¼ë¡œ ì•±ì´ ì–´ë–»ê²Œ ë˜ëŠ”ê°€?

- modified: res/layout/activity_main.xml
- modified: AndroidManifest.xml
- new file: res/font/days_one.xml
- new file: res/values/font_certs.xml
- new file: res/values/preloaded_fonts.xml

### 34p, ë³€ê²½ì 

https://speakerdeck.com/takahirom/support-libraryfalsedownloadable-fontsyaemojicompatnidui-ying-sitaapuriwozuo-rou?slide=34

### 35p ~ 40p, activity_main.xml / days_one.xml

#### layout/activity_main.xml

```xml
<TextView
    android:layout_width="wrap_content"
    android:layout_height="wrap_content"
    android:fontFamily="@font/days_one"
    android:text="Hello World!"
/>
```

TextViewì—ì„œ Font Resourceë¥¼ ì§€ì •

#### font/days_one.xml

```xml
<?xml version="1.0" encoding="utf-8"?>
<font-family
    xmlns:app="http://schemas.android.com/apk/res-auto"
    android:fontProviderAuthority="com.google.android.gms.fonts"
    android:fontProviderPackage="com.google.android.gms"
    android:fontProviderQuery="Days One"
    android:fontProviderCerts="@array/com_goolge_android_gms_fonts_certs">       
</font-family>
```

ì•„ë˜ë¥¼ ì§€ì •í•œë‹¤

- í°íŠ¸ëª…

Google Play Services

- íŒ¨í‚¤ì§€ëª…
- authority
- ì„œëª…ì´ ì í˜€ìˆëŠ” ë¦¬ì†ŒìŠ¤

#### preloaded_fonts.xml

```xml
<?xml version="1.0" encoding="utf-8"?>
<resources>
    <array name="preloaded_fonts" translatable="false">
        <item>@font/days_one</item>
    </array>
</resources>
```

preloaded_fontsì—ëŠ” Font Resourceê°€ ì§€ì •ë˜ì–´ ì´ Fontê°€ preload ëœë‹¤

#### values/font_certs.xml

```xml
<resources>
    <array name="com_goolge_android_gms_fonts_certs">
       <item>@array/com_goolge_android_gms_fonts_certs_dev</item>
       <item>@array/com_goolge_android_gms_fonts_certs_prod</item>
    </array>
    <string-array name="com_goolge_android_gms_fonts_certs_dev">
       <item>
          MIIEqDCCA5C...
       </item>
    </string-array>
    <string-array name="com_goolge_android_gms_fonts_certs_prod">
       <item>
          MIIEQzCCAyug...
       </item>
    </string-array>
</resources>
```

ì„œëª… íŒŒì¼ë¡œëŠ” ê¸¸ë‹¤. ë¬¸ìì—´ì´ í¬í•¨ë˜ì–´ ìˆë‹¤ (ìì„¸í•œ ë‚´ìš©ì€ ë‚˜ì¤‘ì— ì„¤ëª…)

#### app/src/main/AndroidManifest.xml

```xml
<application
    android:allowBackup="true"
    android:icon="@minmap/ic_launcher"
    android:label="@string/app_name"
    android:roundIcon="@minmap/ic_launcher_round"
    android:supportsRtl="true"
    android:theme="@style/AppTheme"
    >
    <meta-data
        android:name="preloaded_fonts"
        android:resource="@array/preloaded_fonts"
        />
```

manifest íŒŒì¼ì— preloaded_fonts ê°€ ì¶”ê°€ë˜ì–´ ìˆë‹¤

### 41p ~ 47p, Downloadable Font êµ¬ì¡°

Support Libraryì™€ Platform êµ¬í˜„ì´ ìˆì–´ ê¸°ë³¸ì ìœ¼ë¡œ ê°™ë‹¤

- (AppCompat)TextViewë¡œë¶€í„° ì–»ì–´ë‚´ê¸° ì–´ë µë‹¤
- ì·¨ë“ì²˜ ì•±ì˜ ì„œëª… ì²´í¬
- ContentResolverë¥¼ í†µí•´ Google Play Servicesë¡œë¶€í„° Fontë¥¼ ì–»ëŠ”ë‹¤

> â€» Support Library 27.0.2ë¥¼ ê¸°ì¤€ìœ¼ë¡œ ì´ì•¼ê¸°í•©ë‹ˆë‹¤

### 48p, AppCompatTextViewë¡œë¶€í„° ì–»ì–´ë‚´ê¸° ì–´ë µë‹¤

```java
// AppCompatViewInflater.java
switch (name) {
    case "TextView":
        view = new AppCompatTextView(context, attrs);
        break;
    case "ImageView":
        view = new AppCompatImageView(context, attrs);
        break;
}
```

ë ˆì´ì•„ì›ƒì˜ "TextView" ëŒ€ì‹ ì— AppCompatTextView ê°€ ë§Œë“¤ì–´ì§„ë‹¤

### 49p, AppCompatTextViewë¡œë¶€í„° ì–»ì–´ë‚´ê¸° ì–´ë µë‹¤

AppCompatTextView ìƒì„±ì

â†’ AppCompatTextHelper#loadFromAttributes()

â†’ TintTypedArray#getFont()

ì—¬ê¸°ì—ì„œ

ResourceCompat#getFont()ë¥¼ ì‚¬ìš©í•´ Fontë¥¼ ì–»ëŠ”ë‹¤

### 50p ~ 53p, AppCompatTextHelper

```java
ResourcesCompat.FontCallback replyCallback =
    new ResourcesCompat.FontCallback replyCallback() {
    @Override
    public void onFontRetrieved(@NonNull Typeface typeface) {
        onAsyncTypefaceReceived(textViewWeak, typeface);
    } 
    @Override
    public void onFontRetrievalFailed(int reason) {
        // Do nothing.
    }
};

try {
    // Note the callback will be triggered on the UI thread.
    mFontTypeface = a.getFont(fontFamilyId, mStyle, replyCallback);
    mAsyncFontPending = mFontTypeface == null;
} catch (UnsupportedOperationException | Resource.NotFoundException e) {
    // Expected if it is not a font resource.
}

private void onAsyncTypefaceReceived(WeakReference<TextView> textViewWeak, Typeface typeface) {
    if (mAsyncFontPending) {
        mFontTypeface = typeface;
        final TextView textView = textViewWeak.get();
        if (textView != null) {
            textView.setTypeface(typeface, mStyle);
        }
    }
}
```

ë¹„ë™ê¸°ë¡œ ì²˜ë¦¬í•´ì„œ ì–»ì—ˆë‹¤ë©´ textView#setTypeface() ë¡œ ì„¤ì •í•œë‹¤

### 54p, Downloadable Font êµ¬ì¡°

Support Libraryì™€ Platform êµ¬í˜„ì´ ìˆì–´ ê¸°ë³¸ì ìœ¼ë¡œ ê°™ë‹¤

- (AppCompat)TextViewë¡œë¶€í„° ì–»ì–´ë‚´ê¸° ì–´ë µë‹¤
- `ì·¨ë“ì²˜ ì•±ì˜ ì„œëª… ì²´í¬`
- ContentResolverë¥¼ í†µí•´ Google Play Servicesë¡œë¶€í„° Fontë¥¼ ì–»ëŠ”ë‹¤

â€» Support Library 27.0.2ë¥¼ ê¸°ì¤€ìœ¼ë¡œ ì´ì•¼ê¸°í•©ë‹ˆë‹¤

### 55p, PackageManagerë¥¼ ì‚¬ìš©í•´ íŒ¨í‚¤ì§€ì˜ ì„œëª… ì²´í¬

- ì œëŒ€ë¡œ í°íŠ¸ë¥¼ ì–»ìœ¼ë ¤ëŠ” ê³³ì´ Google Play Services ì¸ì§€ ì²´í¬í•œë‹¤
- Google Play Servicesì™€ íŒ¨í‚¤ì§€ëª…ì´ ë™ì¼í•œì§€, ë‹¤ë¥¸ ê°€ì§œ ì•±ì—ì„œ ì˜ëª»ëœ í°íŠ¸ë¥¼ ì–»ì§€ ì•Šë„ë¡ í•˜ê¸° ìœ„í•œ êµ¬ì¡°

### 56p, PackageManagerë¥¼ ì‚¬ìš©í•´ íŒ¨í‚¤ì§€ì˜ ì„œëª… ì²´í¬

FontsContractCompat

```java
List<byte[]> signatures;
PackageInfo packageInfo = packageManager.getPackageInfo(info.packageName, PackageManager.GET_SIGNATURES); // info.packageName => "com.google.android.gms" = Google Play Services

// PackageManagerë¡œë¶€í„° Google Play Services ì•±ì˜ Signatureë¥¼ ì–»ì–´ ë°”ì´íŠ¸ ë°°ì—´ë¡œ ë³€í™˜í•œë‹¤
signatures = convertToByteArrayList(packageInfo.signatures);

List<List<byte[]>> requestCertificatesList = getCertificates(request, resources);
for (int i = 0; i < requestCertificatesList.size(); ++i) {
    List<byte[]> requestSignatures = new ArrayList<>(requestCertificatesList.get(i));
    Collections.sort(requestSignatures, sByteArrayComparator);
    // ë°”ì´íŠ¸ ë°°ì—´ì„ ë¹„êµí•´ì„œ ë™ì¼í•˜ë©´ ì •ë³´ë¥¼ ë°˜í™˜í•œë‹¤
    if (equalsByteArrayList(signatures, requestSignatures)) {
        return info;
    }
}
return null;
```

### 58p, Downloadable Font êµ¬ì¡°

Support Libraryì™€ Platform êµ¬í˜„ì´ ìˆì–´ ê¸°ë³¸ì ìœ¼ë¡œ ê°™ë‹¤

- (AppCompat)TextViewë¡œë¶€í„° ì–»ì–´ë‚´ê¸° ì–´ë µë‹¤
- ì·¨ë“ì²˜ ì•±ì˜ ì„œëª… ì²´í¬
- `ContentResolverë¥¼ í†µí•´ Google Play Servicesë¡œë¶€í„° Fontë¥¼ ì–»ëŠ”ë‹¤`

â€» Support Library 27.0.2ë¥¼ ê¸°ì¤€ìœ¼ë¡œ ì´ì•¼ê¸°í•©ë‹ˆë‹¤

### 59p ~ 60p, í°íŠ¸ ì·¨ë“ì€ ContentResolverë¥¼ í†µí•´ Google Play Servicesë¡œë¶€í„° ì·¨ë“

í°íŠ¸ ì·¨ë“ì€ 3ì¤‘ìœ¼ë¡œ Wrapping ë˜ì–´ êµ¬í˜„ë˜ì–´ ìˆë‹¤

`ContentResolver ì²˜ë¦¬` - FontsContractCompat - ResourceCompat

### 61p, í°íŠ¸ ì·¨ë“ì€ ContentResolverë¥¼ í†µí•´ Google Play Servicesë¡œë¶€í„° ì·¨ë“

ContentResolverì™€ ContentProviderëŠ” Androidì— ì˜¤ë˜ì „ë¶€í„° ìˆì—ˆë‹¤

ì• í”Œë¦¬ì¼€ì´ì…˜ê°„ì˜ ë°ì´í„°ë¥¼ ì£¼ê³ ë°›ëŠ” êµ¬ì¡°

### 62p ~ 63p, êµ¬ì¡° í•´ì„¤ : í°íŠ¸ ì·¨ë“ì€ ContentResolverë¥¼ í†µí•´ Google Play Servicesë¡œë¶€í„° ì·¨ë“

ì‹¤ì œë¡œ ContentResolverë¥¼ í†µí•´ Goolge Play Serviceë¡œë¶€í„° ì–»ì„ ìˆ˜ ìˆìŠµë‹ˆë‹¤

```kotlin
val fileBaseUri = Uri.Builder().scheme(ContentResolver.SCHEME_CONTENT)
	.authority("com.google.android.gms.fonts")
	.build()

var cursor = contentResolver.query(
    uri,
    arrayOf(	// ContentResolverë¥¼ ì‚¬ìš©í•´ ì–»ëŠ”ë‹¤
        FontsContractCompat.Columns._ID, 
        FontsContractCompat.Columns.FILE_ID, 
        FontsContractCompat.Columns.TTC_INDEX,
    	""
    ),
    "query = ?",
    arrayOf("Days One"),   // í°íŠ¸ ì´ë¦„
    null
)
```

### 64p, í°íŠ¸ ì·¨ë“ì€ ContentResolverë¥¼ í†µí•´ Google Play Servicesë¡œë¶€í„° ì·¨ë“

í°íŠ¸ ì·¨ë“ì€ 3ì¤‘ìœ¼ë¡œ Wrapping ë˜ì–´ êµ¬í˜„ë˜ì–´ ìˆë‹¤

ContentResolver ì²˜ë¦¬ - `FontsContractCompat` - ResourceCompat

### 65p ~ 67p, êµ¬ì¡° í•´ì„¤ : FontsContractCompat

ì¡°ê¸ˆ ì „ì˜ ContentResolver ë°©ë²•ì—ëŠ” ì„œëª… ì²´í¬ê°€ í¬í•¨ë˜ì–´ ìˆì§€ ì•Šê³ , ì•ˆì „í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤.

 FontsContractë¥¼ ì‚¬ìš©í•˜ë©´ íŒ¨í‚¤ì§€ ì²´í¬ë„ í•´ì£¼ë¯€ë¡œ ì•ˆì „í•˜ê²Œ ê°€ì ¸ì˜¬ ìˆ˜ ìˆìŠµë‹ˆë‹¤

```kotlin
val request = FontRequest(
    "com.google.android.gms.fonts",
    "com.google.android.gms",
    "Days One",
    R.array.com_google_android_gms_fonts_certs_prod
)
// FontRequestë¥¼ ì‘ì„±
// ContentResolverì— í•„ìš”í•œ Authority ì´ë¦„, í°íŠ¸ëª…, ì„œëª…ì´ ë“¤ì–´ìˆëŠ” ë¦¬ì†ŒìŠ¤ë¥¼ ì§€ì •í•œë‹¤
FontsContractCompat.requestFont(
    this,
    request,
    object : FontsContractCompat.FontRequestCallback() {
        override fun onTypefaceRetrieved(typeface: Typeface?) {
            // Callbackì„ í†µí•´ TextViewì˜ typefaceì— ì„¤ì •í•œë‹¤
            textView.typeface = typeface
        }

        override fun onTypefaceRequestFailed(reason: Int) {
            super.onTypefaceRequestFailed(reason)
        }
    }, Handler()
)
```

### 68p, í°íŠ¸ ì·¨ë“ì€ ContentResolverë¥¼ í†µí•´ Google Play Servicesë¡œë¶€í„° ì·¨ë“

í°íŠ¸ ì·¨ë“ì€ 3ì¤‘ìœ¼ë¡œ Wrapping ë˜ì–´ êµ¬í˜„ë˜ì–´ ìˆë‹¤

ContentResolver ì²˜ë¦¬ - FontsContractCompat - `ResourceCompat`

### 69p, ResourceCompatì„ ì‚¬ìš©í•´ Font Resourceë¥¼ ì–»ëŠ”ë‹¤

FontsContractCompatì€ ContentProviderë³´ë‹¤ ê°„ë‹¨í•˜ì§€ë§Œ, Google Play Servicesì˜ íŒ¨í‚¤ì§€ëª… ì§€ì • ë“±ìœ¼ë¡œ ì–´ë µìŠµë‹ˆë‹¤.

ì¡°ê¸ˆ ì „ ì„¤ëª…í•œ Font Resourceë¥¼ ì‚¬ìš©í•´ë´…ì‹œë‹¤.

Font Resourceë¡œ ì¡°ê¸ˆ ì „ ì‘ì„±í•œ íŒ¨í‚¤ì§€ëª… ë“±ì´ ì í˜€ìˆìŠµë‹ˆë‹¤.

```xml
<?xml version="1.0" encoding="utf-8"?>
<font-family xmlns:app="http://schemas.android.com/apk/res-auto"
    app:fontProviderAuthority="com.google.android.gms.fonts"
    app:fontProviderPackage="com.google.android.gms"
    app:fontProviderQuery="Days One"
    app:fontProviderCerts="@array/com_google_android_gms_fonts_certs">
</font-family>
```

### 70p ~ 71p, ResourcesCompat

ResourcesCompatì„ ì‚¬ìš©í•´ í°íŠ¸ì— ì ‘ê·¼

ìƒë‹¹íˆ ê¹”ë”í•´ì¡ŒìŠµë‹ˆë‹¤.

```kotlin
fontText.typeface = ResourcesCompat.getFont(this, R.font.orbitron)
```

> [X] MainThreadë¥¼ Blockí•´ì„œ ì–»ìœ¼ë¯€ë¡œ ì£¼ì˜í•  í•„ìš”ê°€ ìˆë‹¤

### 72p, ResourcesCompat

ë¹„ë™ê¸°ë¡œ ì‚¬ìš©ë„ ê°€ëŠ¥í•©ë‹ˆë‹¤. (Support Lib 27.0.0ë¶€í„° ì¶”ê°€ëœ ë©”ì†Œë“œ)

```kotlin
ResourcesCompat.getFont(
    this, 
    R.font.orbitron,
    object : ResourcesCompat.FontCallback() {
        override fun onFontRetrieved(typeface: Typeface) {
            fontText.typeface = typeface
        }
        override fun onFontRetrievalFailed(reason: Int) {
        }
    },
    Handler())
```

### 73p

ì–´ë–»ê²Œ Downloadable Fontë¥¼ ì‚¬ìš©í•  ê²ƒ ì¸ê°€?

### 74p

ì•„ì§ Downloadable Fontì— ì¼ë³¸ì–´ëŠ” ì—†ìŠµë‹ˆë‹¤ ğŸ˜‡

### 75p ~ 77p, Downloadable Fontì— ì¼ë³¸ì–´ê°€ ì—†ëŠ” ê²ƒ

Get Started with the Google Fonts for Androidë¼ëŠ” í˜ì´ì§€ì— ì•„ë˜ì™€ ê°™ì´ ìˆìŠµë‹ˆë‹¤ 

> ### Which fonts can I use?
> The entire Google Fonts Open Source collection! Visit [https://fonts.google.com](https://fonts.google.com/) to browse.

fonts.google.comì— ìˆëŠ” í°íŠ¸ë¥¼ ì‚¬ìš©í•  ìˆ˜ ìˆë‹¤!

### 78p ~ 80p, Downloadable Fontì— ì¼ë³¸ì–´ê°€ ì—†ëŠ” ê²ƒ

<u>fonts.google.com</u> ë‚´ì—ëŠ” ì¼ë³¸ì–´ fontëŠ” ì•„ì§ ì—†ë‹¤

<u>fonts.google.com</u> ì—ëŠ” Early Accessë¼ëŠ” í•­ëª©ì´ ìˆê³ ,  ê·¸ í˜ì´ì§€ì—ëŠ” ì¼ë³¸ì–´ í°íŠ¸ê°€ ìˆìŠµë‹ˆë‹¤.

ê·¸ëŸ¬ë¯€ë¡œ,  ê·¸ `Early Accessê°€ ëë‚˜ë©´` ê°€ëŠ¥ì„±ì´ ìˆì–´ë³´ì…ë‹ˆë‹¤ ğŸ˜­

### 81p, Downloadable Fontì— ì¼ë³¸ì–´ê°€ ì—†ëŠ” ê²ƒ

googlesamples/android-DownloadableFonts ì˜ issueì— ì‘ì€ ì €í•­ (ë¬´ì˜ë¯¸)ì„ í–ˆìœ¼ë‹ˆ, â¤ ëˆŒëŸ¬ì£¼ì„¸ìš”.

> [how to request a Noto CJK font? ](https://github.com/googlesamples/android-DownloadableFonts/issues/11#issuecomment-346251488)

### 82p, Downloadable FontëŠ” ì•ˆë˜ì§€ë§Œ Bundled FontëŠ” ê°€ëŠ¥í•˜ë‹¤

Downloadable FontëŠ” ì•„ë‹ˆì§€ë§Œ ë‹¨ìˆœíˆ Bundled Fontë¡œ Font Resourceë¥¼ ì´ìš©í•´ ì‚¬ìš©í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

ê·¸ ë•Œì˜ ê¸°ìˆ ì„ ì†Œê°œí•©ë‹ˆë‹¤.

### 83p, Font Resource ì´ìƒì ì¸ ë„ì…

ë¨¸í‹°ë¦¬ì–¼ ë””ìì¸ì´ë¼ë©´ ì¼ë³¸ì–´ëŠ” ê³ ë°€ë„(Dense Script)ì´ë©° Noto í°íŠ¸ë¥¼ ê¸°ì¤€ìœ¼ë¡œ ì‘ì„±ë©ë‹ˆë‹¤.

ì¼ë³¸ì–´ ë¨¸í‹°ë¦¬ì–¼ ë””ìì¸ì˜ íƒ€ì´í¬ê·¸ë˜í”¼ ì¸ìš©

> ### íƒ€ì´í¬ê·¸ë˜í”¼
> Ice Cream Sandwich ì¶œì‹œ ì´í›„, Android í‘œì¤€ í°íŠ¸ê°€ ëœ ê²ƒì´ Robotoì…ë‹ˆë‹¤. í•œí¸, Robotoì— ëŒ€ì‘í•˜ì§€ ì•ŠëŠ” ì–¸ì–´ìš© Android í‘œì¤€ í°íŠ¸ë¡œ Froyoë¶€í„° ë„ì…ëœ ê²ƒì´ Notoì…ë‹ˆë‹¤. NotoëŠ” ChromeOSì—ì„œ ëª¨ë“  ì–¸ì–´ì—ì— ëŒ€ì‘í•˜ëŠ” í‘œì¤€ í°íŠ¸ë¡œë„ ì‚¬ìš©ë˜ê³  ìˆìŠµë‹ˆë‹¤.

> ê³ ë°€ë„ : ì»¤ë‹¤ë€ ê¸€ë¦¬í”„(Glyph)ì— ëŒ€ì‘í•˜ë„ë¡ í–‰ê°„ì— ì—¬ìœ ë¥¼ ê°€ì§ˆ í•„ìš”ê°€ ìˆëŠ” ì–¸ì–´ì˜ ë¬¸ì. ì¤‘êµ­ì–´, ì¼ë³¸ì–´, í•œêµ­ì–´ê°€ í•´ë‹¹í•©ë‹ˆë‹¤. Notoì—ëŠ” í•´ë‹¹ ì–¸ì–´ì— ëŒ€í•´ 7ì¢…ë¥˜ì˜ Weidthê°€ ìˆìŠµë‹ˆë‹¤.

### 84p ~ 86p, Font Resource ì´ìƒì ì¸ ë„ì…

ë¨¸í‹°ë¦¬ì–¼ ë””ìì¸ì˜ Dense script í•­ëª© ì¸ìš©

<img src="http://materialdesignblog.com/wp-content/uploads/2015/03/typography-material-design-sp.png" width="50%" />

ê°ê° í¬ê¸°ì™€ í°íŠ¸ê°€ ì„¤ì •ë˜ì–´ ìˆë‹¤

### 87p, Font Resource ì´ìƒì ì¸ ë„ì…

ê°ê°ì˜ TextAppearance ê°€ ì¤€ë¹„ë˜ì–´ ìˆì–´ fontFamilyì™€ í¬ê¸°ë¥¼ ì§€ì •

ì—¬ê¸°ì—ì„œ font/notosans_medium.otf ë“± FontFamily ì•±ì— ë„£ëŠ”ë‹¤

DroidKaigi 2018 ì¸ìš©

```xml
<style name="TextAppearance.App.Title" parent="TextAppearance.AppCompat.Title">
    <item name="android:textSize">21sp</item>
    <item name="android:fontFamily">@font/notosans_medium</item>
</style>

<style name="TextAppearance.App.Subhead" parent="TextAppearance.AppCompat.Subhead">
    <item name="android:textSize">17sp</item>
    <item name="android:fontFamily">@font/notosans_regular</item>
</style>
```

### 88p ~ 90p, Font Resource ì´ìƒì ì¸ ë„ì…

TextViewì— ì§€ì •í•œë‹¤

```xml
<TextView
    android:id="@+id/speaker_name"
    android:textAppearance="@style/TextAppearance.App.Body1"
    android:layout_width="wrap_content"
    android:layout_height="wrap_content"
```

ì˜ ì›€ì§ì¸ë‹¤ ğŸ™†â€â™€ï¸

`X` Toolbarì˜ Title ë“± ê¸°ë³¸ í°íŠ¸ë„ app:textAppearance ë“±ìœ¼ë¡œ ì„¤ì •í•´ì•¼ í•œë‹¤

### 91p, ê¸°ë³¸ í°íŠ¸ ì„¤ì •

í…Œë§ˆìª½ì—ì„œ ì–´ë–»ê²Œ ì•ˆë ê¹Œ?

```xml
<style name="AppTheme" parent="Theme.AppCompat.Light">
    <item name="android:textAppearance">@style/TextAppearance.hogehoge</item>
    <item name="android:textAppearanceSmall">@style/TextAppearance..</item>
    <item name="android:textAppearanceButton">@style/TextAppearance</item>
    <item name="android:textAppearanceMediumInverse">@style/TextAppearance</item>
```

`X` ê°€ëŠ¥í•˜ì§€ë§Œ ë§ì´ ìˆë‹¤. í˜ë“¬

### 92p, ê¸°ë³¸ í°íŠ¸ ì„¤ì •

christens/Calligraphyë¥¼ ì‚¬ìš©

Calligraphyë€ Android Standard ë¼ì´ë¸ŒëŸ¬ë¦¬ë¡œ ê¸°ë³¸ í°íŠ¸ë¥¼ ì„¤ì • ê°€ëŠ¥

``` java
@Override
public void onCreate() {
    super.onCreate();
    CalligraphyConfig.initDefault(
        new CalligraphyConfig.Builder()
        	.setDefaultFontPath("fonts/Roboto-RobotoRegular.ttf")
    		.setFontAttrId(R.attr.fontPath)
    		.build()
    );
```

`X` í•˜ì§€ë§Œ CalligraphyëŠ” ì˜¤ë˜ì „ë¶€í„° ìˆë˜ ë¼ì´ë¸ŒëŸ¬ë¦¬ë¡œ ìƒˆë¡œìš´ Font ResourceëŠ” ì§€ì •í•  ìˆ˜ ì—†ê³ , í˜¸í™˜ì„±ë„ ì—†ë‹¤

### 93p ~ 95p, ê¸°ë³¸ í°íŠ¸ ì„¤ì •

- ë˜í•œ "Calligraphy is dead"ë¼ê³   ì œì‘ìê°€ ì´ì•¼ê¸°í–ˆìœ¼ë¯€ë¡œ ì•ìœ¼ë¡œëŠ” ì‚¬ìš©í•˜ì§€ ì•ŠëŠ” í¸ì´ ì¢‹ë‹¤
- ê·¸ë¦¬ê³  migration guideëŠ” ì°¾ì„ ìˆ˜ ì—†ì—ˆë‹¤. ğŸ˜‡

https://twitter.com/chrisjenx/status/865273111129726977

### 96p ~ 97p, ì´ ì„¸ì…˜ì˜ ë‚´ìš©

#### â–ªï¸ï¸ë‚´ìš©

ì–´ë–¤ êµ¬ì¡°ë¡œ ì›€ì§ì´ëŠ”ê°€.

Downloadable Fontsì˜ ì¼ë³¸ì–´ í°íŠ¸ ëŒ€ì‘ ìƒí™©ì— ëŒ€í•´.

`ì‹¤ì œë¡œ Calligraphyë¥¼ Downloadable Fontsë“±ì˜ Font Resourcesë¡œ êµì²´í•˜ëŠ” ë°©ë²•.` ğŸ˜‡

EmojiCompatì˜ API level 19ì— ì–´ë–»ê²Œ ëŒ€ì‘í•˜ëŠ”ê°€.

ì–´ë–»ê²Œ í…ŒìŠ¤íŠ¸í•˜ëŠ”ê°€.

ë“± ì‹¤ì²œì ì¸ ë¶€ë¶„ì„ ì†Œê°œí•©ë‹ˆë‹¤.

### 98p

ë¼ì´ë¸ŒëŸ¬ë¦¬ë¥¼ ë§Œë“¤ì—ˆìŠµë‹ˆë‹¤

### 99p ~ 103p, Font Resourceë¡œ ê¸°ë³¸ í°íŠ¸ë¥¼ ì§€ì •í•˜ëŠ” ë¼ì´ë¸ŒëŸ¬ë¦¬ ë§Œë“¤ì—ˆìŠµë‹ˆë‹¤

Calligraphyë¥¼ êµ¬ì¡°ë¥¼ ì´ìš©í•œ ë¼ì´ë¸ŒëŸ¬ë¦¬ë¥¼ ë§Œë“¤ì—ˆìŠµë‹ˆë‹¤

Calligraphyì™€ ê°™ì€ ìŠ¤í™ìœ¼ë¡œ ì„¤ì •í•˜ëŠ” ê²ƒìœ¼ë¡œ

```java
CalligraphyConfig.initDefault(new CalligraphyConfig.Builder()
	.setDefaultFontPath(R.font.roboto_reqular)
	.build());
```

```java
@Override
protected void attachBaseContext(Context newBase) {
    super.attachBaseContext(CalligraphyContextWrapper.wrap(newBase));
}
```

### 104p ~ 107p, Font Resourceë¡œ ê¸°ë³¸ í°íŠ¸ë¥¼ ì§€ì •í•˜ëŠ” ë¼ì´ë¸ŒëŸ¬ë¦¬ ë§Œë“¤ì—ˆìŠµë‹ˆë‹¤

DroidKaigi ì•±ì—ì„œ ì œëŒ€ë¡œ ì›€ì§ì´ê³  ìˆìŠµë‹ˆë‹¤

[https://github.com/DroidKaigi/conference-app-2018/pull/39](https://github.com/DroidKaigi/conference-app-2018/pull/39)

ì—¬ê¸°ì— ìˆëŠ” ì‚¬ëŒì´ **Start** í•´ì„œ ìœ ëª…í•œ ë¼ì´ë¸ŒëŸ¬ë¦¬ê°€ ëœë‹¤ë©´ ì•ˆì‹¬í•´ì„œ ì‚¬ìš©í•  ìˆ˜ ìˆì„ í„°ì´ë‹¤. ğŸ™‡ğŸ»â€â™‚ï¸

takahirom/DownloadableCalligraphy

[https://github.com/takahirom/DownloadableCalligraphy](https://github.com/takahirom/DownloadableCalligraphy)

### 108p

ì—¬ê¸°ê¹Œì§€ê°€ 50~60%

14:15ë¼ë©´ í˜ì´ìŠ¤ëŒ€ë¡œ

### 109p

EmojiCompat

### 110p ~ 112p, EmojiCompat ì†Œê°œ

<img src="https://developer.android.com/guide/topics/ui/images/look-and-feel/emoji-compat/emoji-comparison.png" />

tohu  â˜ ë¥¼ ë§‰ì„ ìˆ˜ ìˆë‹¤

> [https://developer.android.com/guide/topics/ui/look-and-feel/emoji-compat](https://developer.android.com/guide/topics/ui/look-and-feel/emoji-compat) ì¸ìš©

### 113p, EmojiCompat ì†Œê°œ

- ìµœì‹  ì´ëª¨í‹°ì½˜ì„ Android OS ì—…ë°ì´íŠ¸ ì—†ì´ ì‚¬ìš©í•  ìˆ˜ ìˆë‹¤
- ì´í‹€ ì „ (2018/02/07) Unicode Emoji 11.0ê°€ ì¶œì‹œë˜ì–´ 157ê°œì˜ ìƒˆë¡œìš´ ì´ëª¨í‹°ì½˜ì´ ì¶”ê°€ë˜ì—ˆìŠµë‹ˆë‹¤.
- ë‹¹ë¶„ê°„ ë¶ˆê°€í”¼í•©ë‹ˆë‹¤.

[http://blog.unicode.org/2018/02/unicode-emoji-110-characters-now-final.html?m=1](http://blog.unicode.org/2018/02/unicode-emoji-110-characters-now-final.html?m=1)

### 114p, EmojiCompat ì†Œê°œ

- API Level 19
- DownloadableFont ë²„ì „ê³¼ Bundle ë²„ì „ì´ ìˆë‹¤
- Bundle ë²„ì „ì€ ì´ëª¨í‹°ì½˜ì´ ë¼ì´ë¸ŒëŸ¬ë¦¬ ë‚´ì— í¬í•¨ë˜ì–´ ìˆì–´ 6.5MB ì´ë¯€ë¡œ íŠ¹ìˆ˜í•œ ì‚¬ì •ì´ ì•„ë‹Œ ê²½ìš°, ê¸°ë³¸ì ìœ¼ë¡œëŠ” Downloadable Font ë²„ì „ì´ ì¢‹ë‹¤ê³  ìƒê°í•œë‹¤ 

### 115p ~ 117p, EmojiCompat ê¸°ë³¸ì ì¸ ì‚¬ìš© ë°©ë²•

Application#onCreate

```kotlin
val fontRequest = FontRequest(
	"com.google.android.gms.fonts",
	"com.google.android.gms",
	"Noto Color EmojiCompat",
	R.array.com_google_android_gms_fonts_certs)	
val config = FontRequestEmojiCompatConfig(context, fontRequest)

EmojiCompat.init(config)
```

ì¡°ê¸ˆì „ì˜ Font Requestë¥¼ ì‚¬ìš©í•´ EmojiCompat.init() ìœ¼ë¡œ ì´ˆê¸°í™”

```groovy
implementation "com.android.support:support-emoji:27.0.2"
```

### 118p, EmojiCompat ê¸°ë³¸ì ì¸ ì‚¬ìš© ë°©ë²•

ë‚˜ë¨¸ì§€ëŠ” ê¸°ë³¸ì ìœ¼ë¡œ ì•„ë˜ì™€ ê°™ì´ ì´ëª¨í‹°ì½˜ì´ ì‚¬ìš©ë˜ëŠ” ê³³ì— ê°ê° Viewë¥¼ ì‚¬ìš©

```xml
<android.support.text.emoji.widget.EmojiAppCompatTextView
	android:id="@+id/text"
	android:layout_width="wrap_content"
	android:layout_height="wrap_content"
	/>
<android.support.text.emoji.widget.EmojiAppCompatEditText
	android:id="@+id/edit"
	android:layout_width="wrap_content"
	android:layout_height="wrap_content"
	/>
...
```

```groovy
implementation "com.android.support:support-emoji-appcompat:27.0.2"
```

### 119p, EmojiCompat Module

- 3ê°€ì§€ Moduleì´ ì¡´ì¬í•œë‹¤

```groovy
implementation "com.android.support:support-emoji:27.0.2"
implementation "com.android.support:support-emoji-appcompat:27.0.2"
implementation "com.android.support:support-emoji-bundled:27.0.2"
```

Download ë²„ì „

â†’ emoji-appcompat

Bundle ë²„ì „ì„ ì´ìš©í•˜ëŠ” ê²½ìš°

â†’ emoji-bundled

â†’ emoji-appcompat

### 120p, EmojiCompat.Configì— ë”°ë¥¸ ì„¤ì •

```kotlin
.setEmojiSpanIndicatorEnabled(true)
.setEmojiSpanIndicatorColor(Color.GREEN)
```

EmojiCompatì— ë”°ë¼ êµì²´ê°€ ì´ë£¨ì–´ì§€ëŠ” ë¶€ë¶„ì„ ì•Œ ìˆ˜ ìˆë‹¤. (ë””ë²„ê·¸ìš©)

### 121p, EmojiCompat.Configì— ë”°ë¥¸ ì„¤ì •

```kotlin
.setReplaceAll(true)
```

ì‹œìŠ¤í…œì´ í‘œì‹œ ë¶ˆê°€ëŠ¥í•œ ì´ëª¨í‹°ì½˜ë§Œì„ êµì²´í•˜ëŠ” ê²ƒì´ ì•„ë‹ˆë¼ ì „ë¶€ë¥¼ êµì²´í• ì§€ ì—¬ë¶€

í†µì¼ê°ì„ ê°€ì§„ë‹¤ë©´ ì „ë¶€ êµì²´í•˜ëŠ” í¸ì´ ì¢‹ë‹¤

### 122p ~ 123p, êµ¬ì¡°ì— ë“¤ì–´ê°€ê¸° ì „ì— ì´ëª¨í‹°ì½˜ì— ëŒ€í•´ì„œ

JavaëŠ” í†µìƒ, 16ë¹„íŠ¸ì˜ char ë°ì´í„° íƒ€ì…ì„ ì‚¬ìš©

ê·¸ëŸ¬ë‚˜ 16ë¹„íŠ¸ì— í¬í•¨ë˜ì§€ ëª»í•œ ì´ëª¨í‹°ì½˜ ë“±ì€ **32ë¹„íŠ¸, 2ê°œì˜ charì„ ì‚¬ìš©í•´ í‘œí˜„ëœë‹¤**.

ì´ ë°©ë²•ì„ Surrogate Pairë¼ê³  í•œë‹¤.

### 124p, êµ¬ì¡°ì— ë“¤ì–´ê°€ê¸° ì „ì— ì´ëª¨í‹°ì½˜ì— ëŒ€í•´ì„œ

Surrogate PairëŠ” 31ë¹„íŠ¸ ê°’ìœ¼ë¡œ í‘œí˜„í•œë‹¤

ê·¸ê²ƒì„ `Code Point` ë¼ê³   í•œë‹¤

ğŸ‘¨ = U+1F468 = \ud83d\udc68

â€‹              â†‘ Code Point

### 125p, êµ¬ì¡°ì— ë“¤ì–´ê°€ê¸° ì „ì— ì´ëª¨í‹°ì½˜ì— ëŒ€í•´ì„œ

ì–´ëŠ Code Pointê°€ ì–´ë–¤ ì´ëª¨í‹°ì½˜ì— ëŒ€ì‘í•˜ëŠ”ì§€ Emoji Chartsë¡œ í™•ì¸í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤

[http://unicode.org/emoji/charts/full-emoji-list.html](http://unicode.org/emoji/charts/full-emoji-list.html)

### 126p ~ 128p, êµ¬ì¡°ì— ë“¤ì–´ê°€ê¸° ì „ì— ì´ëª¨í‹°ì½˜ì— ëŒ€í•´ì„œ

Code Pointë¥¼ ì–»ê±°ë‚˜ ë¬¸ìì—´ë¡œ ê³ ì¹  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

 ```kotlin
// String -> code point
val face = "\ud83d\udc68"
// Character.toCodePointì— charë¥¼ 2ê°œ ë„˜ê¸¸ ë¿ë¿ë¿ë¿
val codePoint: Int = Character.toCodePoint(face[0], face[1])
println(Integer.toHexString(codePoint))

// code point -> String
// Character.toCharsì— Code Pointë¥¼ ë„˜ê¸¸ ë¿
val charArray: CharArray = Character.toChars(codePoint)
val string = String(charArray)
println(string)
 ```

### 129p, êµ¬ì¡°ì— ë“¤ì–´ê°€ê¸° ì „ì— ì´ëª¨í‹°ì½˜ì— ëŒ€í•´ì„œ

ë³µìˆ˜ Code Pointë¡œë¶€í„° ë§Œë“¤ì–´ì§„ ì´ëª¨í‹°ì½˜ì´ ì¡´ì¬í•œë‹¤

![ğŸ‘¨â€ğŸ’»](data:image/png;base64,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)

| U+1F468 | U+1F3FB | U+200D | U+1F4BB |
| ------- | ------- | ------ | ------- |
| ğŸ‘¨       | ğŸ»       | ZWJ    | ğŸ’»       |

> ZWJ = ë¬¸ìë¥¼ ê²°í•©ì‹œí‚¤ëŠ” ì œì–´ë¬¸ì

### 130p, êµ¬ì¡°ì— ë“¤ì–´ê°€ê¸° ì „ì— ì´ëª¨í‹°ì½˜ì— ëŒ€í•œ íŠœí† ë¦¬ì–¼

- ì´ê²ƒë„ Emoji Charts í˜ì´ì§€ì—ì„œ í™•ì¸í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤

https://speakerdeck.com/takahirom/support-libraryfalsedownloadable-fontsyaemojicompatnidui-ying-sitaapuriwozuo-rou?slide=130

### 131p ~ 132p, êµ¬ì¡°ì— ë“¤ì–´ê°€ê¸° ì „ì— ì´ëª¨í‹°ì½˜ì— ëŒ€í•œ

ì´ Code Pointë¥¼ Codeë¡œ í‘œí˜„í•˜ê¸° ìœ„í•´ì„œëŠ”?

| U+1F468 | U+1F3FB | U+200D | U+1F4BB |
| ------- | ------- | ------ | ------- |
| ğŸ‘¨       | ğŸ»       | ZWJ    | ğŸ’»       |

```kotlin
val face = Character.toChars(0x1f468)
val lightSkin = Character.toChars(0x1f3fb)
val zwj = Character.toChars(0x200d)
val computer = Character.toChars(0x1f4bb)
val programmer = face + lightSkin + zwj + computer
programmer.forEach {
    println(Integer.toHexString(it.toInt()))
}
```

ì´ê²ƒì„ ë¨¼ì € charì˜ arrayë¥¼ ì–»ì–´

ë‹¤ìŒ ìŠ¬ë¼ì´ë“œì—ì„œ "programmer"ë¥¼ ì‚¬ìš©

### 133p ~ 134p, êµ¬ì¡°ì— ë“¤ì–´ê°€ê¸° ì „ì— ì´ëª¨í‹°ì½˜ì— ëŒ€í•´ì„œ

```kotlin
textView.typeface = ResourcesCompat.getFont(this, R.font.noto_color_emoji)
textView.text = String(programmer)
// or
textView.text = "\ud83d\udc68\ud83c\udffb\u200d\ud83d\udcbb"
```

EmojiCompatì´ ì—†ì–´ë„ ì´ëª¨í‹°ì½˜ì€ ë™ì‘í•˜ì§€ë§Œ

### 135p, EmojiCompatì´ ì—†ìœ¼ë©´?

- í°íŠ¸ë¥¼ ì „ë¶€ êµì²´í•˜ë©´ ì´ëª¨í‹°ì½˜ ì´ì™¸ì˜ ë¶€ë¶„ì—ì„œ Custom Font ëŒ€ì‘í•  ìˆ˜ ì—†ë‹¤
- Android 4.4ì—ì„œëŠ” ì¼ë°˜ Noto Color Emoji Fontë¥¼ ì½ì–´ ë“¤ì¼ ë•Œì— Exceptionì´ ì¼ì–´ë‚œë‹¤

â†’ ì œëŒ€ë¡œ êµì²´í•˜ë©´ì„œ ë‹¤ë¥¸ í°íŠ¸ê°€ í•„ìš” (ì´í›„ EmojiCompatì—ì„œ ì´ì•¼ê¸°í•©ë‹ˆë‹¤)

### 136p ~ 137p, EmojiApppCompatTextViewëŠ” ì–´ë–»ê²Œ ì´ëª¨í‹°ì½˜ì„ ì‚¬ìš©í•˜ëŠ”ê°€?

TextView#setTransformationMethodë¥¼ ì‚¬ìš©

TextViewê°€ í‘œì‹œí•  ë¬¸ìë¥¼ ë³€í™˜í•œë‹¤

Password TransformationMethod ì˜ ì‚¬ë¡€

```xml
<TextView
    android:id="@+id/textView"
    android:text="test"
```

```kotlin
editText.transformationMethod = PasswordTransformationMethod()
```

### 138p ~ 139p, EmojiApppCompatTextViewëŠ” ì–´ë–»ê²Œ ì´ëª¨í‹°ì½˜ì„ ì‚¬ìš©í•˜ëŠ”ê°€?

TransformationMethodë¡œ ReplacementSpanë¼ëŠ” Classë¥¼ í™•ì¥í•œ TypefaceEmojiSpanì„ ì‚¬ìš©í•œë‹¤

ReplacementSpanì—ì„œëŠ” draw ë©”ì†Œë“œë¥¼ overrideí•˜ë©´ ë‹¤ë¥¸ ë¬¸ìë¥¼ ê·¸ë¦¬ê±°ë‚˜ í•  ìˆ˜ ìˆë‹¤

```java
public final class TypefaceEmojiSpan extends EmojiSpan {
...
    @Override
    public void draw(@NonNull final Canvas canvas, ..., @NonNull final Paint paint) {
    	getMetadata().draw(canvas, x, y, paint);
    }
...
}
```

```java
// EmojiMetadata.java
public void draw(@NonNull final Canvas canvas, final float x, ..., @NonNull final Paint paint) {
    final Typeface typeface = mMetadataRepo.getTypeface();
    ...
    paint.setTypeface(typeface);
    ...
    canvas.drawText(..., paint);
}
```

paintì— setTypefaceí•´ì„œ canvas.drawText() í•˜ëŠ” ê²ƒ ë¿

### 140p

ì–´ë–»ê²Œ ì´ëª¨í‹°ì½˜ë§Œì„ TypefaceEmojiSpanìœ¼ë¡œ êµì²´í•˜ëŠ”ê°€

### 141p ~ 145p, ë¬¸ìì—´ì˜ ì–´ë””ê¹Œì§€ê°€ ì´ëª¨í‹°ì½˜ì¸ê°€ íŒì •í•˜ëŠ” êµ¬ì¡°

- ê·¸ëŸ° Android APIëŠ” ì—†ì–´ë³´ì¸ë‹¤
- `Font Fileì„ FlatBufferë¡œ ì½ì–´ ì´ëª¨í‹°ì½˜ì˜ íŠ¸ë¦¬ êµ¬ì¡°ë¥¼ ë§Œë“ ë‹¤`

ì´ëª¨í‹°ì½˜ì˜ íŠ¸ë¦¬ êµ¬ì¡° (ê°„ëµí™”)

```kotlin
class Node {
    val children: Map<Int, Node>
    val data
}
```

### 146p ~ 150p, ë¬¸ìì—´ì˜ ì–´ë””ê¹Œì§€ê°€ ì´ëª¨í‹°ì½˜ì¸ê°€ íŒì •í•˜ëŠ” êµ¬ì¡°

root

â†“  ![ğŸ‘¨](data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAEgAAABICAMAAABiM0N1AAAABGdBTUEAALGPC/xhBQAAAAFzUkdCAK7OHOkAAAB7UExURUdwTOmaADocEzocEzocE142ENaIADscE+qaAJNbCjocE3pWIumaAOaWAOSUADsdEuycANiIAJhkFWNANF49Mf/JE//ECv+7AP/BBP/KGVk4LWpGOVMzKP7GEPCiAD09O0gpHnxVQvixAcubHrOFHt2qGZ93Ju+5Fo1pLY3p5LAAAAATdFJOUwDBf8LmH/7++hBC+zWdcKVQ3encbgdsAAAEbElEQVRYw9WY23qqMBCFK1VEEWy/BFAQKkkIvP8T7plJkFAOau/2Cto6SX7WTDjpx8f/pMPu6HnnT9LZ8467w18oAPnc7kfafnrHd1k775Pm3u/3Gwr+3inw6e3exgCDM1ZYMcZvBHsDdSRMzlnxwPSwnFDH1zjeFjEMzbggxDKD2novlOrgwT4xJyS5nphF8dtLJOSQHcSYmQUbKCQ09ZRkONxOcSE9BjwR6Umdt1hlh8OKURs8bVcrvoP1Is4UNYiDcli73XqBbjiur3X/5vzl2DhW3HuaGKfBzKkTYYrBEOfryZ17Q3wo01joxqAgufOqodxyXE+jAlnOmiWsUM5z/jDFp35sZjBquUqwZGAoHzy5q8cGhuGgpYWFO6Ih5AykwRYf+eE4DiwdlzNzSZyPbXAXQ6DZ3A6QmQG5dTJVHxGxn0CQ29wZt8M1u+U2u5wvKe8N4brt5kt0t5wVVD5wbgtFwhLd8nxgTVGPDhp1WygSgQB1Y1pK1YVhwZyZxGVFGHZKSs1wj3BLmAMdzntzwwibK6ptG+AprbsOtk5rBYSmLalThubesj8f5hcNxOV1rPJagn4FJTegmWXDRcPO7veceXUGNLNsPUi9xLmqZyDWvAZq2BLoaEDha5ldy9CAjksgnVxNs0qmDNOrn4BkArq2Dailf+FVJlbX8hFP5BLI1Ig1MKZVXV0UdSctChturTRxhXEs0kqxwxbsaHuTrnWbWAZuj3ihcVS4CtKQCI2voRWFKjEvektKRfGaSBDQCyBzZCsCdXC2wRlV0wRbofKqwSLFO4qrhSPbXNew1q1sy0appmxNkRJL+xWXC1e2A97UWJuUOE3/gMhOSVtSmrhy4i2Dy8jMSbsL4cIWIqhMJI7/4dJCSgo+4j+SPrchPJOE0xrFCnbQGVBnJujeSt+0iXc4Jmk7SEHFE1DkawCVpO4xIYXWv7lx/Agg7UeTEm18P9yDBxxi96wMNrVvae9IUyjV+9D3N4cpKFB3ldDUhuF41pCXNKEXtqag2jVkMoHhwTwoCFVKKmX48xPK9LcSN35RYTADghpB2LczSjhr23RGbtz3q2Bao4/Y94OquqQv61IBx5+u2ul7AXTJoF0u86Dv08e8pSy9jJSmogpAlUixx+3N5g1BuSNIWlx+SwQkYTDpgwV78P1o9rH9EH9DblNShYam8ar6jpce/0+bKpshCTETzarNafk5O57b9bxEFa88+Z8C11LWNA5XNE02KvVp7TtEhJYy22RdayXxvtE0Uum6lkOfqKLVLzVfYKkfiyAUPIuYfwDU9z0zRJZ6UiZUPZJyup4YoirBcKOLkN2A6aRABEk8NQQHOCb3UKUsqlNuWATx8++0lFy/70sm4MYBD2uDG8RX0QvfjuGoFNmqxNqx+AapepFDpBXU65w1khDvcLDigUEJ2oYXXMyid35lgUN8gyhjqyciZvP19q9QMaKA1atCTPyX36IOXxGxrIJN9PWnn7ToyeIURxtSFJ92H/+X/gEYLRbsXCO1gQAAAABJRU5ErkJggg==)+ codepoint = U+1F468

![ğŸ‘¨](data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAEgAAABICAMAAABiM0N1AAAABGdBTUEAALGPC/xhBQAAAAFzUkdCAK7OHOkAAAB7UExURUdwTOmaADocEzocEzocE142ENaIADscE+qaAJNbCjocE3pWIumaAOaWAOSUADsdEuycANiIAJhkFWNANF49Mf/JE//ECv+7AP/BBP/KGVk4LWpGOVMzKP7GEPCiAD09O0gpHnxVQvixAcubHrOFHt2qGZ93Ju+5Fo1pLY3p5LAAAAATdFJOUwDBf8LmH/7++hBC+zWdcKVQ3encbgdsAAAEbElEQVRYw9WY23qqMBCFK1VEEWy/BFAQKkkIvP8T7plJkFAOau/2Cto6SX7WTDjpx8f/pMPu6HnnT9LZ8467w18oAPnc7kfafnrHd1k775Pm3u/3Gwr+3inw6e3exgCDM1ZYMcZvBHsDdSRMzlnxwPSwnFDH1zjeFjEMzbggxDKD2novlOrgwT4xJyS5nphF8dtLJOSQHcSYmQUbKCQ09ZRkONxOcSE9BjwR6Umdt1hlh8OKURs8bVcrvoP1Is4UNYiDcli73XqBbjiur3X/5vzl2DhW3HuaGKfBzKkTYYrBEOfryZ17Q3wo01joxqAgufOqodxyXE+jAlnOmiWsUM5z/jDFp35sZjBquUqwZGAoHzy5q8cGhuGgpYWFO6Ih5AykwRYf+eE4DiwdlzNzSZyPbXAXQ6DZ3A6QmQG5dTJVHxGxn0CQ29wZt8M1u+U2u5wvKe8N4brt5kt0t5wVVD5wbgtFwhLd8nxgTVGPDhp1WygSgQB1Y1pK1YVhwZyZxGVFGHZKSs1wj3BLmAMdzntzwwibK6ptG+AprbsOtk5rBYSmLalThubesj8f5hcNxOV1rPJagn4FJTegmWXDRcPO7veceXUGNLNsPUi9xLmqZyDWvAZq2BLoaEDha5ldy9CAjksgnVxNs0qmDNOrn4BkArq2Dailf+FVJlbX8hFP5BLI1Ig1MKZVXV0UdSctChturTRxhXEs0kqxwxbsaHuTrnWbWAZuj3ihcVS4CtKQCI2voRWFKjEvektKRfGaSBDQCyBzZCsCdXC2wRlV0wRbofKqwSLFO4qrhSPbXNew1q1sy0appmxNkRJL+xWXC1e2A97UWJuUOE3/gMhOSVtSmrhy4i2Dy8jMSbsL4cIWIqhMJI7/4dJCSgo+4j+SPrchPJOE0xrFCnbQGVBnJujeSt+0iXc4Jmk7SEHFE1DkawCVpO4xIYXWv7lx/Agg7UeTEm18P9yDBxxi96wMNrVvae9IUyjV+9D3N4cpKFB3ldDUhuF41pCXNKEXtqag2jVkMoHhwTwoCFVKKmX48xPK9LcSN35RYTADghpB2LczSjhr23RGbtz3q2Bao4/Y94OquqQv61IBx5+u2ul7AXTJoF0u86Dv08e8pSy9jJSmogpAlUixx+3N5g1BuSNIWlx+SwQkYTDpgwV78P1o9rH9EH9DblNShYam8ar6jpce/0+bKpshCTETzarNafk5O57b9bxEFa88+Z8C11LWNA5XNE02KvVp7TtEhJYy22RdayXxvtE0Uum6lkOfqKLVLzVfYKkfiyAUPIuYfwDU9z0zRJZ6UiZUPZJyup4YoirBcKOLkN2A6aRABEk8NQQHOCb3UKUsqlNuWATx8++0lFy/70sm4MYBD2uDG8RX0QvfjuGoFNmqxNqx+AapepFDpBXU65w1khDvcLDigUEJ2oYXXMyid35lgUN8gyhjqyciZvP19q9QMaKA1atCTPyX36IOXxGxrIJN9PWnn7ToyeIURxtSFJ92H/+X/gEYLRbsXCO1gQAAAABJRU5ErkJggg==) `data: F0048`

â†“ ğŸ» â† codepoint = U+1F3FB (node.children.get(0x1F3FB))

![ğŸ‘¨](data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAEgAAABICAMAAABiM0N1AAAABGdBTUEAALGPC/xhBQAAAAFzUkdCAK7OHOkAAAB7UExURUdwTOmaADocEzocEzocE142ENaIADscE+qaAJNbCjocE3pWIumaAOaWAOSUADsdEuycANiIAJhkFWNANF49Mf/JE//ECv+7AP/BBP/KGVk4LWpGOVMzKP7GEPCiAD09O0gpHnxVQvixAcubHrOFHt2qGZ93Ju+5Fo1pLY3p5LAAAAATdFJOUwDBf8LmH/7++hBC+zWdcKVQ3encbgdsAAAEbElEQVRYw9WY23qqMBCFK1VEEWy/BFAQKkkIvP8T7plJkFAOau/2Cto6SX7WTDjpx8f/pMPu6HnnT9LZ8467w18oAPnc7kfafnrHd1k775Pm3u/3Gwr+3inw6e3exgCDM1ZYMcZvBHsDdSRMzlnxwPSwnFDH1zjeFjEMzbggxDKD2novlOrgwT4xJyS5nphF8dtLJOSQHcSYmQUbKCQ09ZRkONxOcSE9BjwR6Umdt1hlh8OKURs8bVcrvoP1Is4UNYiDcli73XqBbjiur3X/5vzl2DhW3HuaGKfBzKkTYYrBEOfryZ17Q3wo01joxqAgufOqodxyXE+jAlnOmiWsUM5z/jDFp35sZjBquUqwZGAoHzy5q8cGhuGgpYWFO6Ih5AykwRYf+eE4DiwdlzNzSZyPbXAXQ6DZ3A6QmQG5dTJVHxGxn0CQ29wZt8M1u+U2u5wvKe8N4brt5kt0t5wVVD5wbgtFwhLd8nxgTVGPDhp1WygSgQB1Y1pK1YVhwZyZxGVFGHZKSs1wj3BLmAMdzntzwwibK6ptG+AprbsOtk5rBYSmLalThubesj8f5hcNxOV1rPJagn4FJTegmWXDRcPO7veceXUGNLNsPUi9xLmqZyDWvAZq2BLoaEDha5ldy9CAjksgnVxNs0qmDNOrn4BkArq2Dailf+FVJlbX8hFP5BLI1Ig1MKZVXV0UdSctChturTRxhXEs0kqxwxbsaHuTrnWbWAZuj3ihcVS4CtKQCI2voRWFKjEvektKRfGaSBDQCyBzZCsCdXC2wRlV0wRbofKqwSLFO4qrhSPbXNew1q1sy0appmxNkRJL+xWXC1e2A97UWJuUOE3/gMhOSVtSmrhy4i2Dy8jMSbsL4cIWIqhMJI7/4dJCSgo+4j+SPrchPJOE0xrFCnbQGVBnJujeSt+0iXc4Jmk7SEHFE1DkawCVpO4xIYXWv7lx/Agg7UeTEm18P9yDBxxi96wMNrVvae9IUyjV+9D3N4cpKFB3ldDUhuF41pCXNKEXtqag2jVkMoHhwTwoCFVKKmX48xPK9LcSN35RYTADghpB2LczSjhr23RGbtz3q2Bao4/Y94OquqQv61IBx5+u2ul7AXTJoF0u86Dv08e8pSy9jJSmogpAlUixx+3N5g1BuSNIWlx+SwQkYTDpgwV78P1o9rH9EH9DblNShYam8ar6jpce/0+bKpshCTETzarNafk5O57b9bxEFa88+Z8C11LWNA5XNE02KvVp7TtEhJYy22RdayXxvtE0Uum6lkOfqKLVLzVfYKkfiyAUPIuYfwDU9z0zRJZ6UiZUPZJyup4YoirBcKOLkN2A6aRABEk8NQQHOCb3UKUsqlNuWATx8++0lFy/70sm4MYBD2uDG8RX0QvfjuGoFNmqxNqx+AapepFDpBXU65w1khDvcLDigUEJ2oYXXMyid35lgUN8gyhjqyciZvP19q9QMaKA1atCTPyX36IOXxGxrIJN9PWnn7ToyeIURxtSFJ92H/+X/gEYLRbsXCO1gQAAAABJRU5ErkJggg==) `data: F0606`

â†“ ZWJ (ë¬¸ìë¥¼ ê²°í•©ì‹œí‚¤ëŠ” ì œì–´ë¬¸ì)

...

### 151p, ë¬¸ìì—´ì˜ ì–´ë””ê¹Œì§€ê°€ ì´ëª¨í‹°ì½˜ì¸ê°€ íŒì •í•˜ëŠ” êµ¬ì¡°

ì´ dataì˜ Code PointëŠ” EmojiCompatì˜ Fontê°€ ê°€ì§€ê³  ìˆëŠ” Private Use Areaì— ë§µí•‘ë˜ì–´ìˆì–´ ê·¸ê³³ì„ ì°¸ì¡°í•˜ê³  ìˆë‹¤.

- Font File ë‚´ì˜ Mapping

| data: F0048 | <map code="0xf0048" name="u1F468" /> |
| data: F0606 | <map code="0xf0606" name="uF0606" /> |

### 152p, ì´ëª¨í‹°ì½˜ì„ íŒì •í•˜ëŠ” êµ¬ì¡°

ì´ Treeë¥¼ ì‚¬ìš©í•´ ë¬¸ìì—´ì—ì„œ í•˜ë‚˜ì”© Code Pointë¥¼ ì½ì–´ Treeì— ìˆëŠ” dataë¥¼ ì ìš©í•´ë‚˜ê°„ë‹¤

```java
int currentOffset = start;
int codePoint = Character.codePointAt(charSequence, currentOffset);

while (currentOffset < end && addedCount < maxEmojiCount) {
    final int action = sm.check(codePoint);
    
    switch (action) {
        case ACTION_ADVANCE_BOTH:
            start += Character.charCount(Character.codePointAt(charSequence, start));
            currentOffset = start;
            if (currentOffset < end) {
                codePoint = Character.codePointAt(charSequence, currentOffset);
            }
...
```

### 153p ~ 157p, ì–´ë–»ê²Œ EmojiCompatì„ ì‚¬ìš©í•  ê²ƒ ì¸ê°€?

- ê°„ë‹¨í•˜ê²Œ ì´ìš©í•  ìˆ˜ ìˆë‹¤
- Downloadable Font ë²„ì „ì„ ì¶”ì²œ
- ë§ì€ ë¬¸ìê°€ ë‚˜ì˜¤ëŠ” ì•±ì—ì„œëŠ” í‘œí˜„ì´ ëŠ˜ì–´ë‚˜ë¯€ë¡œ ì¢‹ë‹¤
- ê¸°ë³¸ì ìœ¼ë¡œ ëª¨ë“  ì´ëª¨í‹°ì½˜ì„ êµì²´ ê°€ëŠ¥í•œ ReplaceAllì„ ê¸°ë³¸ì ìœ¼ë¡œ ì‚¬ìš©í•˜ëŠ” í¸ì´ ì¢‹ì•„ ë³´ì¸ë‹¤

### 158p, EmojiCompatì€ API Level 19

Emoji Fontê°€ ì´ìš©í•  ìˆ˜ ìˆê²Œ ëœ ê²ƒì€ API Level 19ë¶€í„° ìˆìœ¼ë¯€ë¡œ,

EmojiCompatì˜ ê¸°ëŠ¥ì€ API Level 18 ë¯¸ë§Œì€ ì‚¬ìš©í•  ìˆ˜ ì—†ë‹¤

### 159p, EmojiCompatì€ API Level 19

EmojiAppCompatTextViewì˜ ì½”ë©˜íŠ¸

- When used on devices running API 18 or below, this widget acts as a regular {@link AppCompatTextView}.
- API Level 19 ë¯¸ë§Œì—ì„œëŠ” ë‹¨ìˆœíˆ TextViewë¡œì„œ ë‹¤ë£¨ë¯€ë¡œ ì§€ê¸ˆì²˜ëŸ¼ ë™ì‘í•œë‹¤
- ì¼ë°˜ Productì—ì„œëŠ” 4.4 ë¯¸ë§Œ ìœ ì €ìˆ˜ëŠ” ì ì–´ì§€ê³  ìˆê¸° ë•Œë¬¸ì— ê±±ì •í•˜ì§€ ì•Šì•„ë„ ì¢‹ì•„ë³´ì¸ë‹¤.

### 160p ~ 161p, Downloadable Fontì˜ í…ŒìŠ¤íŠ¸ ë°©ë²•

- Emulatorë¡œ í•˜ëŠ” ê²½ìš°ëŠ” Play Store ë²„ì „ì„ ì„¤ì¹˜
- ê·¸ë¦¬ê³  Google Play servicesì˜ ë²„ì „ ì—…ë°ì´íŠ¸ë¥¼ í•  ìˆ˜ ìˆë‹¤
- ê·¸ëŸ¬ë©´ ë™ì‘í•œë‹¤

### 162p, í…ŒìŠ¤íŠ¸ ë°©ë²•

- ê¸°ë³¸ì ìœ¼ë¡œ ë°”ë€Œì—ˆëŠ”ê°€ ì•„ë‹Œê°€ë¡œ í™•ì¸í•  ìˆ˜ ìˆë‹¤
- Font ì°¨ì´ëŠ” í™•ì¸í•˜ëŠ” ê²ƒì€ ì–´ë ¤ìš°ë¯€ë¡œ murooka/go-diff-image ë“±ìœ¼ë¡œ í™•ì¸í•˜ëŠ” ê²ƒì´ ì¢‹ì•˜ë‹¤
- ì œëŒ€ë¡œ ë™ì‘í•˜ì§€ ì•Šì„ ë•ŒëŠ” Support Libraryì´ë¯€ë¡œ í‰ì†Œì²˜ëŸ¼ Debugë¡œ ë³¼ ìˆ˜ ìˆê³  ì½”ë“œë„ ì½ì„ ìˆ˜ ìˆë‹¤
- Support Library ê°±ì‹  ì´ë ¥ì„ ë³´ë©´ Bug Fixedë¥¼ ë¹ˆë²ˆí•˜ê²Œ í•˜ë¯€ë¡œ ì£¼ì‹œí•˜ëŠ” í¸ì´ ì¢‹ë‹¤

### 163p, ì •ë¦¬

- Downloadable Fontë„ EmojiCompatë„ ì•„ì£¼ ê°„ë‹¨í•˜ê²Œ ì‚¬ìš©í•  ìˆ˜ ìˆë‹¤
- DownloadableCalligraphyë¥¼ Start ëˆŒëŸ¬ì£¼ì„¸ìš” â­ï¸
- Downloadable FontëŠ” ì•„ì‰½ì§€ë§Œ ì§€ê¸ˆì€ ì¼ë³¸ì–´ì— ëŒ€ì‘í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤ë§Œ, ê³§ ëŒ€ì‘í• ì§€ë„ ëª¨ë¦…ë‹ˆë‹¤ ğŸ˜­
- EmojiCompatì´ API Level 19ì¸ ë¶€ë¶„ì€ 19 ë¯¸ë§Œì˜ ìœ ì €ëŠ” ì ì–´ ì‚¬ìš©í•  ìˆ˜ ì—†ëŠ” ê²ƒì€ ì•„ë‹ˆê¸° ë•Œë¬¸ì— ì‚¬ìš©í•´ë²„ë ¤ë„ ì¢‹ì•„ ë³´ì¸ë‹¤

### 164p, ì°¸ê³ ë¬¸í—Œ / ì¸ìš©

- Android Developers [https://developer.android.com/index.html](https://developer.android.com/index.html)
- Android Open Source Project [https://source.android.com](https://source.android.com)
- Emoji Charts [http://unicode.org/emoji/charts/full-emoji-list.html](http://unicode.org/emoji/charts/full-emoji-list.html)
- Exploring the Android EmojiCompat Library [https://medium.com/exploring-android/exploring-the-android-emoji-compatibility-library-1b9f3bb724aa](https://medium.com/exploring-android/exploring-the-android-emoji-compatibility-library-1b9f3bb724aa)
- Google I/O [https://www.youtube.com/watch?v=1N9KveJ-FU8](https://www.youtube.com/watch?v=1N9KveJ-FU8)
- potatotips #41ì—ì„œ Android Fontì˜ ì‹ ê¸°ëŠ¥ì— ëŒ€í•´ ë°œí‘œí–ˆìŠµë‹ˆë‹¤. [https://qiita.com/tsuyosh/items/372b785e395397877d2c](https://qiita.com/tsuyosh/items/372b785e395397877d2c))
- Java ì—ì„œì˜ Unicode Surrogate Programming [https://www.ibm.com/developerworks/jp/ysl/library/java/j-unicode_surrogate/index.html](https://www.ibm.com/developerworks/jp/ysl/library/java/j-unicode_surrogate/index.html)
- Androidê°€ 4.4ì—ì„œ ì´ëª¨í‹°ì½˜ì„ ì œëŒ€ë¡œ ëŒ€ì‘ [https://mstssk.blogspot.jp/2014/02/emoji.html](https://mstssk.blogspot.jp/2014/02/emoji.html))

### 165p, Sample

[https://github.com/takahirom/droidkaigi-2018-fonts](https://github.com/takahirom/droidkaigi-2018-fonts)