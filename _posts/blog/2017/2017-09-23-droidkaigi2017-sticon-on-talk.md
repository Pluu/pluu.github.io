---
layout: post
title: "[ë²ˆì—­] DroidKaigi 2017 ~ í† í¬ ì•±ì—ì„œ ì´ëª¨í‹°ì½˜ì„ êµ¬í˜„í•œ ì´ì•¼ê¸°"
date: 2017-08-23 18:10:00 +09:00
tag: [Android, DroidKaigi]
categories:
- blog
- Android
- DroidKaigi
---

ë³¸ í¬ìŠ¤íŒ…ì€ [DroidKaigi 2017 ~ ãƒˆãƒ¼ã‚¯ã‚¢ãƒ—ãƒªã§çµµæ–‡å­—ã‚’å®Ÿè£…ã—ãŸè©±](https://speakerdeck.com/futaboooo/tokuapuridehui-wen-zi-woshi-zhuang-sitahua) ì„ ê¸°ë³¸ìœ¼ë¡œ ë²ˆì—­í•˜ì—¬ ì‘ì„±í–ˆìŠµë‹ˆë‹¤

ì œ ì¼ë³¸ì–´ ì‹¤ë ¥ìœ¼ë¡œ ì¸í•˜ì—¬ ì˜¤ì—­ì´ë‚˜ ì˜¤íƒ€ê°€ ë°œìƒí•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

<!--more-->

- - -

## 1p, í† í¬ ì•±ì—ì„œ ì´ëª¨í‹°ì½˜ì„ êµ¬í˜„í•œ ì´ì•¼ê¸°

DroidKaigi 2017 @futabooo

## 2p, About me

futabooo (ãµãŸã¶ãƒ¼)

- Lead Engineer at eureka, Inc. 
- Java, Kotlin, Golang, TypeScript, AngularJS 
- FantasyEarth Zero, s.CRY.ed 

- Github : futabooo 
- Twitter : futabooo

## 3p, About eureka

[https://eure.jp/](https://eure.jp/)

## 4p, About eureka

|  |  |
| :--: | :--: |
| <img src="https://lh3.googleusercontent.com/-H_9o7dHUXUPfkTjOgkKnoHIpKjKFkNDDIMUsYGdkFLX3Vo-F9BEanv3FrMYFSI3QD28=w300-rw" width="50%" /> | <img src="https://lh3.googleusercontent.com/669EqenWA1N1WbfZUTppFO_gMDBd59OsPXK50dqHkSSXBtq6XYPwI6WYkXhTBc86Zg=w300-rw"  width="50%" /> |
| [pairs](https://play.google.com/store/apps/details?id=jp.eure.android.pairs&hl=ko) | [COUPLES](https://play.google.com/store/apps/details?id=jp.eure.couples&hl=ja) |

## 5p, About eureka

<img src="https://lh3.googleusercontent.com/-H_9o7dHUXUPfkTjOgkKnoHIpKjKFkNDDIMUsYGdkFLX3Vo-F9BEanv3FrMYFSI3QD28=w300-rw" width="10%" />

- Web
   - Golang, Gin
   - TypeScript, AngularJS
- Android
   - Java, Kotlin
   - Dagger2, Orma, OkHttp3, Retroï¬t2, RxKotlin, Picasso, ButterKnife, DataBinding
- iOS
   - Objective-C, Swift
   - CoreStore, Alamoï¬re, Moya RxSwift, AsyncDisplayKit

<img src="https://lh3.googleusercontent.com/669EqenWA1N1WbfZUTppFO_gMDBd59OsPXK50dqHkSSXBtq6XYPwI6WYkXhTBc86Zg=w300-rw"  width="10%" />

- Web
   - PHP, Codeigniter
- Android
   - Java
   - ActiveAndroid, Volley, OkHttp3, Retroï¬t2, Socket.IO, RxJava, Glide
- iOS
   - Swift, Objective-C
   - CoreStore, AFNetworking, SwiftyJSON, SDWebImage RxSwift, Cartography

## 6p, About Couples

ì•¨ë²”, ê¸°ë…ì¼, ìŠ¤ì¼€ì¤„ì„ í•˜ë‚˜ë¡œ

ë‘ ì‚¬ëŒì˜ ì¶”ì–µì„ ê°„ë‹¨í•˜ê²Œ ê³µìœ 

## 7p, About Couples

Talk

## 8p, About Couples

Talk

- ë¬¸ì ë©”ì‹œì§€
- ì´ëª¨í‹°ì½˜
- ìŒì„± ë©”ì‹œì§€
- ì´ë¯¸ì§€
- ë™ì˜ìƒ
- ìŠ¤íƒ¬í”„
- ìœ„ì¹˜ ì •ë³´
- Thinking of You

## 9p, About Couples

Talk

- ë¬¸ì ë©”ì‹œì§€
- `ì´ëª¨í‹°ì½˜`
- ìŒì„± ë©”ì‹œì§€
- ì´ë¯¸ì§€
- ë™ì˜ìƒ
- ìŠ¤íƒ¬í”„
- ìœ„ì¹˜ ì •ë³´
- Thinking of You

## 10p

ì•± ìì²´ ì´ëª¨í‹°ì½˜ ë„ì… ì „

## 11p

â—† Couplesì— ëŒ€í•œ ì˜ê²¬ãƒ»ê°ìƒ

ì´ë¯¸ì§€ì²˜ëŸ¼ ì´ëª¨í‹°ì½˜ì´ í‘œì‹œë˜ì§€ ì•ŠìŠµë‹ˆë‹¤! ë‚´ê°€ ë³´ë‚¸ ê²ƒì€ í‘œì‹œë˜ëŠ” ê²ƒ ê°™ìŠµë‹ˆë‹¤!

## 12p

ë‹¨ë§ì´ë‚˜ í†µì‹ ì‚¬ì˜ ì°¨ì´ì— ë”°ë¼ ì œëŒ€ë¡œ ì´ëª¨í‹°ì½˜ í‘œì‹œê°€ ì•ˆëœë‹¤

## 13p

ìì²´ ì´ëª¨í‹°ì½˜ì„ ë„£ì

## 14p

Couples ìì²´ ì´ëª¨í‹°ì½˜ ë„ì…ê¹Œì§€ì˜ íë¦„

## 15p, Couples ìì²´ ì´ëª¨í‹°ì½˜ ë„ì…ê¹Œì§€ì˜ íë¦„

- ì‚¬ì–‘ì„ ì •í•œë‹¤
   - íƒ€ì‚¬ ì•±ì—ì„œ ìì²´ ì´ëª¨í‹°ì½˜ì´ êµ¬í˜„ëœ ê²ƒì„ ì—°êµ¬í•œë‹¤
      - ê¸°ëŠ¥ì„ íŒŒí—¤ì¹œë‹¤
      - í€„ë¦¬í‹° í™•ì¸
- ê°œë°œí•œë‹¤
   - ì‚¬ì–‘ ê²°ì •ìœ¼ë¡œ ë°í˜€ì§„ ê¸°ëŠ¥ êµ¬í˜„

## 16p

íƒ€ì‚¬ ì•± ì—°êµ¬

## 17p, íƒ€ì‚¬ ì•± ì—°êµ¬

- íƒ€ì‚¬ ì•±ì—ì„œ ìì²´ ì´ëª¨í‹°ì½˜ì´ ìˆëŠ” ì•±ì„ ì˜¤ë¡œì§€ ì‚¬ìš©í•œë‹¤.
   - LINE, Facebook Messenger, etc...
   - ë²„ê·¸ë¥¼ ì°¾ì„ ì •ë„ì˜ ì—´ì •ìœ¼ë¡œ ì´ê²ƒì €ê²ƒ í•œë‹¤

## 18p, íƒ€ì‚¬ ì•± ì—°êµ¬

- ê¸°ëŠ¥ì„ íŒŒí—¤ì¹œ ê²°ê³¼
   - ì´ëª¨í‹°ì½˜ì„ í‘œì‹œí•  ìˆ˜ ìˆë‹¤
   - ì´ëª¨í‹°ì½˜ ë³µì‚¬ & ë¶™ì—¬ë„£ê¸°ë¥¼ í•  ìˆ˜ ìˆë‹¤
      - ì•± ë°–ìœ¼ë¡œ ë¶™ì—¬ë„£ê¸°í•˜ë©´ ëŒ€ì²´ ë¬¸ìë¡œ í‘œì‹œëœë‹¤
   - ì´ëª¨í‹°ì½˜ í•˜ë‚˜ë§Œ ë³´ë‚´ë©´ ìŠ¤íƒ¬í”„ê°€ ëœë‹¤

## 19p

ì—¬ê¸°ì„œë¶€í„° ê°œë°œ ì´ì•¼ê¸°ì…ë‹ˆë‹¤

## 20p

ì´ëª¨í‹°ì½˜ì„ í‘œì‹œí•œë‹¤

## 21p, ì´ëª¨í‹°ì½˜ì„ í‘œì‹œ

- ì²˜ë¦¬ íë¦„
   - í‘œì‹œí•  ë¬¸ìì—´ ì¤‘ì—ì„œ ì´ëª¨í‹°ì½˜ì— ëŒ€ì‘í•˜ëŠ” ë¶€ë¶„ì„ ì‹ë³„í•œë‹¤
   - í‘œì‹œí•  ë¬¸ìì—´ì˜ ì–´ë””ì— ì–´ë–¤ ì´ëª¨í‹°ì½˜ì„ í‘œì‹œí• ì§€ë¥¼ ìœ ì§€í•˜ëŠ” ë¦¬ìŠ¤íŠ¸ë¥¼ ì‘ì„±í•œë‹¤
   - í‘œì‹œí•  ë¬¸ìì—´ì„ SpannableStringìœ¼ë¡œ í•´ì„œ, ë¦¬ìŠ¤íŠ¸ë¥¼ ê¸°ë°˜ìœ¼ë¡œ ëŒ€ì‘í•˜ëŠ” ë¶€ë¶„ì„ ì´ëª¨í‹°ì½˜ìœ¼ë¡œ ê·¸ë¦°ë‹¤

## 22p ~ 25p, ì´ëª¨í‹°ì½˜ì„ í‘œì‹œ

- ì²˜ë¦¬ íë¦„

String íƒ€ì…

ì•ˆë…•í•˜ì„¸ìš”`{ { sticon(1,10) } }`ì˜¤ëŠ˜ì€ ë‚ ì”¨ê°€ ì¢‹ë„¤ìš”!`{ { sticon(2,20) } }`

SpannableString íƒ€ì…

ì•ˆë…•í•˜ì„¸ìš”ğŸ»ì˜¤ëŠ˜ì€ ë‚ ì”¨ê°€ ì¢‹ë„¤ìš”!ğŸŒ

| TalkMessageToken |
| :-- |
| characterStyle: SticonSpan |
| beginIndex: int |
| endIndex: int |

| DynamicDrawableSpan | SticonSpan |
| :-- | :-- |
| draw() | sticon: Drawable |
|   | altText: Sting |

## 26p ~ 31p, ì´ëª¨í‹°ì½˜ì„ í‘œì‹œ

- ì²˜ë¦¬ íë¦„

```
// í‘œì‹œí•˜ê³  ì‹¶ì€ ë¬¸ìì—´
String message = "ì•ˆë…•í•˜ì„¸ìš”{ { sticon(1,10) } } ì˜¤ëŠ˜ì€ ë‚ ì”¨ê°€ ì¢‹ë„¤ìš”!{ { sticon(2,20) } }"

// ì–´ë””ì— ì–´ë–¤ ì´ëª¨í‹°ì½˜ì„ í‘œì‹œí• ì§€ë¥¼ ìœ ì§€í•œ ë¦¬ìŠ¤íŠ¸ë¥¼ ì–»ëŠ”ë‹¤
List<TalkMessageToken> tokenList = TalkMessageHelper.getSticonSpanTokens(message);

// ë¦¬ìŠ¤íŠ¸ë¥¼ ê¸°ë°˜ìœ¼ë¡œ ë¬¸ìì—´ì— ì´ëª¨í‹°ì½˜ì„ ëŒ€ì‘ì‹œì¼œ ê·¸ë¦°ë‹¤
SpannableString spanedMessage = new SpannableString(message);
for (TalkMessageToken t : tokenList) {
    spanedMessage.setSpan(t.characterStyle, t.beginIndex, t.endIndex, t.flags);
}
talkView.setText(spanedMessage);
```

## 32p ~ 37p, ì´ëª¨í‹°ì½˜ì„ í‘œì‹œ

- { { mustache } }
   - Logic-less templates
   - ê°„ë‹¨í•œ êµì²´ë¥¼ í•˜ëŠ” í…œí”Œë¦¿
   - Java êµ¬í˜„ samskivert/jmustache

```
String text = "One, two, { { three } }. Three sir!";
Template tmpl = Mustache.compiler().compile(text);
Map<> data = new HashMap<String, String>();
data.put("three", "five");
System.out.println(tmpl.execute(data));
//result: "One, two, five. Three sir!"
```

## 38p, ì´ëª¨í‹°ì½˜ì„ í‘œì‹œ

- samskivert/jmustache
   - ë¬¸ì to ë¬¸ìì˜ êµì²´ë¼ë©´ ì¶©ë¶„í•˜ë‹¤
      - ì´ëª¨í‹°ì½˜ìœ¼ë¡œ í•˜ë ¤ë©´ ê²°êµ­ êµ¬í˜„ì´ í•„ìš”
   - ë¼ì´ë¸ŒëŸ¬ë¦¬ëŠ” ì‚¬ìš©í•˜ì§€ ì•Šê³ , íŒŒì„œë¥¼ ìì²´ êµ¬í˜„

## 39p, ì´ëª¨í‹°ì½˜ì„ í‘œì‹œ

- ìì²´ íŒŒì„œ
   - mustacheë¥¼ ì‚¬ìš©í•˜ë©´ì„œ ì •ê·œí‘œí˜„ì‹ìœ¼ë¡œ í•œë‹¤
      - Matcherì™€ Patternì„ ì‚¬ìš©í•œë‹¤
      - { { sticon(1,10) } } â†’ ëŒ€ì‘í•˜ëŠ” ì´ëª¨í‹°ì½˜ ğŸ» ì„ í‘œì‹œí•˜ê¸° ìœ„í•œ Spanì„ ì‘ì„±í•œë‹¤

## 40p, ì´ëª¨í‹°ì½˜ì„ í‘œì‹œ

- { { sticon(1,10) } }
   - sticonì€ ì´ëª¨í‹°ì½˜ì„ ë§í•¨
   - sticon(ê·¸ë£¹ID, ID), IDëŠ” ëª¨ë“  sticonì—ì„œ í•˜ë‚˜ì˜ ì˜ë¯¸
      - ëª¨ë“  sticonì—ì„œ í•˜ë‚˜ì˜ ì˜ë¯¸ì˜ IDëŠ” ìŠ¤íƒ¬í”„ë¡œì„œ ì „ì†¡ì‹œì— í™œì•½

## 41p ~ 46p, ì´ëª¨í‹°ì½˜ì„ í‘œì‹œ

- ì–´ë””ì— ì–´ë–¤ ì´ëª¨í‹°ì½˜ì„ í‘œì‹œí• ì§€ë¥¼ ìœ ì§€í•œ ë¦¬ìŠ¤íŠ¸ë¥¼ ì–»ëŠ”ë‹¤

```
// ì •ê·œí‘œí˜„ì‹ì˜ íŒ¨í„´ì„ ì‘ì„±í•œë‹¤
Pattern STICON = Pattern.compile("\\{\\{sticon\\(.+?\\)\\}\\}");
Pattern IDS = Pattern.compile("(\\d+),(\\d+)");
List<TalkMessageToken> getSticonSpanTokens(String rawText) {
   ArrayList<TalkMessageToken> tokens = new ArrayList<>();
   // Matcherë¥¼ ì‚¬ìš©í•´ì„œ íŒ¨í„´ì— ë§¤ì¹˜í•œ ë¶€ë¶„ì— ì²˜ë¦¬í•œë‹¤
   Matcher t = STICON.matcher(rawText);
   Matcher ids = IDS.matcher("");
   while (t.find()) {// { { sticon(1,10) } }ì™€{ { sticon(2,20) } }
      matcherIds.reset(t.group());
      if (ids.find()) {// (1,10)ì™€(2,20) 
         TalkMessageToken token = new TalkMessageToken(sticonSpan, t.start(), t.end());
         tokens.add(token);   
      }
   }
}
```

## 47p ~ 49p, ì´ëª¨í‹°ì½˜ì„ í‘œì‹œ

- TalkMessageToken 
   - ì–´ë””ì— ì–´ë–¤ ìŠ¤íƒ€ì¼ì„ í• ì§€ ìœ ì§€í•œ í´ë˜ìŠ¤

```
class TalkMessageToken {
   public CharacterStyle characterStyle;
   public int beginIndex;
   public int endIndex; 
}
```

ì•ˆë…•í•˜ì„¸ìš”{ { sticon(1,10) } }ì˜¤ëŠ˜ì€ ë‚ ì”¨ê°€ ì¢‹ë„¤ìš”!{ { sticon(2,20) } }

| TalkMessageToken | TalkMessageToken |
| :-- | :-- |
| characterStyle = sticonSpan | characterStyle = sticonSpan |
| beginIndex = 5 | beginIndex = 32 |
| endIndex = 20 | endIndex = 47 |

## 50p ~ 56p, ì´ëª¨í‹°ì½˜ì„ í‘œì‹œ

- SticonSpan 
   - ì‰ëª¨í‹°ì½˜ ì •ë³´ë¥¼ ê°€ì§€ëŠ” í´ë˜ìŠ¤

```
class SticonSpan extends DynamicDrawableSpan {
   Drawable sticon;
   String altText;
   String rawText;
   int stickerId;

   @Override
   public void draw(Canvas canvas, CharSequence text, int start, int end, float x, int top, int y, int bottom, Paint paint) {
      // ìì‹ ì´ ì ìš©ëœ string ë¶€ë¶„ì„ sticonìœ¼ë¡œ ì¹˜í™˜í•˜ì—¬ ê·¸ë¦°ë‹¤
   }
}
```

## 57p, ì´ëª¨í‹°ì½˜ì„ í‘œì‹œ

- ë³µìŠµ

String íƒ€ì…

ì•ˆë…•í•˜ì„¸ìš”{ { sticon(1,10) } }ì˜¤ëŠ˜ì€ ë‚ ì”¨ê°€ ì¢‹ë„¤ìš”!{ { sticon(2,20) } }

SpannableString íƒ€ì…

ì•ˆë…•í•˜ì„¸ìš”ğŸ»ì˜¤ëŠ˜ì€ ë‚ ì”¨ê°€ ì¢‹ë„¤ìš”!ğŸŒ

| TalkMessageToken |
| :-- |
| characterStyle: SticonSpan |
| beginIndex: int |
| endIndex: int |

| DynamicDrawableSpan | SticonSpan |
| :-- | :-- |
| draw() | sticon: Drawable |
|   | altText: Sting |

## 58p

ì´ëª¨í‹°ì½˜ì„ ë³µì‚¬ & ë¶™ì—¬ë„£ê¸°í•  ìˆ˜ ìˆë‹¤

## 59p, ì´ëª¨í‹°ì½˜ì„ ë³µì‚¬ & ë¶™ì—¬ë„£ê¸°

- ì²˜ë¦¬ íë¦„
   - ë³µì‚¬ë˜ë©´ ì•„ë˜ ë¬¸ìì—´ì„ ì•± ë‚´ì—ì„œ ìœ ì§€í•œë‹¤ 
      - ì›ì‹œ í…ìŠ¤íŠ¸ "ì•ˆë…•í•˜ì„¸ìš”{ { sticon(1,10) } }"
      - ëŒ€ì²´ í…ìŠ¤íŠ¸ "ì•ˆë…•í•˜ì„¸ìš”(bo)"
   - ëŒ€ì²´ í…ìŠ¤íŠ¸ë¥¼ í´ë¦½ë³´ë“œì— ë³´ê´€í•œë‹¤
      - Couples ë°–ì—ì„œì˜ ë¶™ì—¬ë„£ê¸°ëŠ” ëŒ€ì²´ í…ìŠ¤íŠ¸ í‘œì‹œ
   - ë³µì‚¬ì‹œì˜ ë¬¸ìì—´ê³¼ ë¹„êµí•˜ê³ ì„œ ë¶™ì—¬ë„£ê¸° í•œë‹¤

## 60p ~ 63p, ì´ëª¨í‹°ì½˜ì„ ë³µì‚¬ & ë¶™ì—¬ë„£ê¸°

- ì²˜ë¦¬ íë¦„

SpannableString íƒ€ì…

ì•ˆë…•í•˜ì„¸ìš”{ { sticon(1,10) } }ì˜¤ëŠ˜ì€ ë‚ ì”¨ê°€ ì¢‹ë„¤ìš”!{ { sticon(2,20) } }

-> Copy

->

| ì•± ë‚´ë¶€ | í´ë¦½ë³´ë“œ |
| :-- | :-- |
| copiedRawText: String | cpoiedAltText: String |
| cpoiedAltText: String |   |
| sticonCpied: boolean |   |

-> Paste

> ì•ˆë…•í•˜ì„¸ìš”ğŸ»ì˜¤ëŠ˜ì€ ë‚ ì”¨ê°€ ì¢‹ë„¤ìš”!ğŸŒ
>
> ì•ˆë…•í•˜ì„¸ìš”(bo)ì˜¤ëŠ˜ì€ ë‚ ì”¨ê°€ ì¢‹ë„¤ìš”!(Sunny)

## 64p ~ 68p, ì´ëª¨í‹°ì½˜ì„ ë³µì‚¬ & ë¶™ì—¬ë„£ê¸°

- ì²˜ë¦¬ íë¦„

```
// ë¬¸ìì—´ì„ ì•±ë‚´ì— ìœ ì§€í•œë‹¤
setCopiedText(message); 
// í´ë¦½ë³´ë“œì— ëŒ€ì²´ í…ìŠ¤íŠ¸ë¥¼ ì €ì¥
altText = TalkMessageHelper.getAltText(message);
String[] mimetype = {ClipDescription.MIMETYPE_TEXT_PLAIN};
ClipData.Item item = new ClipData.Item(altText);
ClipData cd = new ClipData(new ClipDescription("text",mimetype),item);
ClipboardManager cm = (ClipboardManager) getSystemService(CLIPBOARD_SERVICE);
cm.setPrimaryClip(cd); 
// ë³µì‚¬ì‹œì˜ ë¬¸ìì—´ê³¼ ë¹„êµí•œ í›„ì— ë¶™ì—¬ë„£ê¸°
@Override public void afterTextChanged(Editable s) {
   if (isSticonPasted()) {
      // ì´ëª¨í‹°ì½˜ í‘œì‹œ ì²˜ë¦¬
   }
}
```

## 69p, ì´ëª¨í‹°ì½˜ì„ ë³µì‚¬ & ë¶™ì—¬ë„£ê¸°

- ë³µìŠµ

SpannableString íƒ€ì…

ì•ˆë…•í•˜ì„¸ìš”{ { sticon(1,10) } }ì˜¤ëŠ˜ì€ ë‚ ì”¨ê°€ ì¢‹ë„¤ìš”!{ { sticon(2,20) } }

-> Copy

->

| ì•± ë‚´ë¶€ | í´ë¦½ë³´ë“œ |
| :-- | :-- |
| copiedRawText: String | cpoiedAltText: String |
| cpoiedAltText: String |   |
| sticonCpied: boolean |   |

-> Paste

> ì•ˆë…•í•˜ì„¸ìš”ğŸ»ì˜¤ëŠ˜ì€ ë‚ ì”¨ê°€ ì¢‹ë„¤ìš”!ğŸŒ
>
> ì•ˆë…•í•˜ì„¸ìš”(bo)ì˜¤ëŠ˜ì€ ë‚ ì”¨ê°€ ì¢‹ë„¤ìš”!(Sunny)

## 70p

ì´ëª¨í‹°ì½˜ í•˜ë‚˜ë§Œ ë³´ë‚´ë©´ ìŠ¤íƒ¬í”„ê°€ ëœë‹¤

## 71p, ì´ëª¨í‹°ì½˜ í•˜ë‚˜ë§Œ ë³´ë‚´ë©´ ìŠ¤íƒ¬í”„ê°€ ëœë‹¤

- ì²˜ë¦¬ íë¦„
   - ë©”ì‹œì§€ ì†¡ì‹  íƒ€ì´ë°ì— ì´ëª¨í‹°ì½˜ í•˜ë‚˜ì¸ì§€ íŒë‹¨í•œë‹¤
   - ì´ëª¨í‹°ì½˜ í•˜ë‚˜ì¸ ê²½ìš°, ìŠ¤íƒ¬í”„ë¡œ ì†¡ì‹ í•œë‹¤

## 72p ~ 76p, ì´ëª¨í‹°ì½˜ í•˜ë‚˜ë§Œ ë³´ë‚´ë©´ ìŠ¤íƒ¬í”„ê°€ ëœë‹¤

- ìŠ¤íƒ¬í”„ë¡œ ë³´ë‚¼ì§€ë¥¼ íŒë‹¨í•œë‹¤

```
public boolean isSendSticonAsSticker() {
   SticonSpan[] tokens =editText.getText().getSpans(0, editText.getText().length(), SticonSpan.class);
   if(tokens.length == 1) {
      // ì´ëª¨í‹°ì½˜ì„ ë‚˜íƒ€ë‚´ëŠ” ë¬¸ìì—´ì´ í•˜ë‚˜ë§Œ ì…ë ¥ëœ ê²½ìš°
      if(tokens[0].getTemplateString().equals(editText.getText())) {
         return true;
      }
   }
   // ì´ëª¨í‹°ì½˜ì´ í•˜ë‚˜ì´ì§€ ì•Šì€ ê²½ìš°
   return false;
}
```

## 77p ~ 80p, ì´ëª¨í‹°ì½˜ í•˜ë‚˜ë§Œ ë³´ë‚´ë©´ ìŠ¤íƒ¬í”„ê°€ ëœë‹¤

- ìŠ¤íƒ¬í”„ë¥¼ ë³´ë‚¸ë‹¤

```
if (isSendSticonAsSticker()) {
   Editable t = editText.getText()
   SticonSpan[] spans = t.getSpans(0, t.length(), SticonSpan.class);
   // ìŠ¤íƒ¬í”„ë¥¼ ìƒì„±í•´ì„œ ì†¡ì‹ 
   Sticker sticker = new Sticker(spans[0].getSticonId());
   sendStamp(sticker); 
} else {
   // í…ìŠ¤íŠ¸ ë©”ì‹œì§€&ì´ëª¨í‹°ì½˜ìœ¼ë¡œ ì†¡ì‹ 
} 
```

## 81p, ì´ëª¨í‹°ì½˜ í•˜ë‚˜ë§Œ ë³´ë‚´ë©´ ìŠ¤íƒ¬í”„ê°€ ëœë‹¤

- ë³µìŠµ

## 82p

ì‹œê°„ì´ ê±¸ë¦° ë¶€ë¶„

## 83p ~ 84p, ì‹œê°„ì´ ê±¸ë¦° ë¶€ë¶„

- ëŒ€ëŸ‰ì˜ ì´ëª¨í‹°ì½˜ì„ í‘œì‹œí•˜ë©´ ìŠ¤í¬ë¡¤ì´ ëŠê¸´ë‹¤
- ì´ëª¨í‹°ì½˜ ë³µì‚¬&ë¶™ì—¬ë„£ê¸°í•˜ë©´ ë¬¸ìê°€ ì§¤ë¦°ë‹¤

## 85p, ëŒ€ëŸ‰ì˜ ì´ëª¨í‹°ì½˜ì„ í‘œì‹œí•˜ë©´ ìŠ¤í¬ë¡¤ì´ ëŠê¸´ë‹¤

- ìŠ¤í¬ë¡¤ì˜ ëŠê¹€ì€ cache ë„ì…ìœ¼ë¡œ í•´ê²°
   - LruCache
   - ë¬¸ì ì‚¬ì´ì¦ˆì— ë§ì¶°ì„œ ì´ëª¨í‹°ì½˜ ì‚¬ì´ì¦ˆë„ ë³€í™”í•˜ë¯€ë¡œ, keyì— ë¬¸ì ì‚¬ì´ì¦ˆë„ ë„£ëŠ”ë‹¤

## 86p, ëŒ€ëŸ‰ì˜ ì´ëª¨í‹°ì½˜ì„ í‘œì‹œí•˜ë©´ ìŠ¤í¬ë¡¤ì´ ëŠê¸´ë‹¤

- ìŠ¤í¬ë¡¤ì˜ ëŠê¹€ì€ cache ë„ì…ìœ¼ë¡œ í•´ê²°

## 87p, ì‹œê°„ì´ ê±¸ë¦° ë¶€ë¶„

- ëŒ€ëŸ‰ì˜ ì´ëª¨í‹°ì½˜ì„ í‘œì‹œí•˜ë©´ ìŠ¤í¬ë¡¤ì´ ëŠê¸´ë‹¤
- `ì´ëª¨í‹°ì½˜ ë³µì‚¬&ë¶™ì—¬ë„£ê¸°í•˜ë©´ ë¬¸ìê°€ ì§¤ë¦°ë‹¤`

## 88p ~ 91p, ì´ëª¨í‹°ì½˜ ë³µì‚¬&ë¶™ì—¬ë„£ê¸°í•˜ë©´ ë¬¸ìê°€ ì§¤ë¦°ë‹¤

- ë³µì‚¬&ë¶™ì—¬ë„£ê¸°ì˜ ë²”ìœ„ë¥¼ ì¡°ì ˆí•˜ëŠ” ë¡œì§ì„ ì¶”ê°€í•œë‹¤

`ì•ˆë…•í•˜ì„¸ìš”ğŸ»`ì˜¤ëŠ˜ì€ ë‚ ì”¨ê°€ ì¢‹ë„¤ìš”!ğŸŒ

-> Copy

`ì•ˆë…•í•˜ì„¸ìš”{` { sticon(1,10) } } ì´ëŒ€ë¡œëŠ” mustacheì˜ ë„ì¤‘ì— ì§¤ë¦°ë‹¤

->

`ì•ˆë…•í•˜ì„¸ìš”{ { sticon(1,10) } }` ë³µì‚¬&ë¶™ì—¬ë„£ê¸°ë¥¼ mustacheì˜ ì¢…ë‹¨ê¹Œì§€ ëŠ˜ë¦°ë‹¤

## 92p

ì •ë¦¬

## 93p, ì •ë¦¬

- êµ¬í˜„ ë°©ë²•ì„ ëª¨ë¥¼ ë•ŒëŠ” ì°¸ê³ ê°€ ë˜ëŠ” ì•±ì„ ì°¾ì•„ì„œ ë™ì‘ì„ ì¡°ì‚¬í•œë‹¤
- ì´ëª¨í‹°ì½˜ í‘œì‹œì—ëŠ” SpnannableStringê³¼ í™•ì¥í•œ Span í´ë˜ìŠ¤ë¥¼ ì‚¬ìš©
- í‘œì‹œìƒìœ¼ë¡œ ì´ëª¨í‹°ì½˜ìœ¼ë¡œ ë³´ì¼ë¿ì´ê³  textëŠ” ë¬¸ìì—´ì´ ë“¤ì–´ìˆìœ¼ë¯€ë¡œ, ë³µì‚¬&ë¶™ì—¬ë„£ê¸° ë“± EditTextë‚˜ TextViewì˜ ì²˜ë¦¬ëŠ” ì£¼ì˜í•œë‹¤